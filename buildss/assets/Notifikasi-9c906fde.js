import{ah as g,ai as C,aj as G,ak as T,G as D,a as j,r as m,j as a,am as O,al as N}from"./index-b009c0ac.js";import{A as S}from"./ConfirmDialog-ac6f9f6d.js";import{B as l,H as k,A as w,t as r,N as o,aY as R}from"./Views-3aa30f3b.js";import"./chart.constant-a47010a0.js";import"./SvgIcon-60957c66.js";import"./DataTable-1ce7dae1.js";import{b as z,d as y,e as B,c as E}from"./NotificationService-bb524ea4.js";import{f as H}from"./formatDate-07229bbd.js";import"./useThemeClass-c7400041.js";const f="notification",c=g(f+"/getAllNotification",async()=>(await z()).data),u=g(f+"/getOneNotificationAndRead",async n=>(await y(n)).data),F={loading:!1,loadingGetOne:!1,dataOneNotification:[],dataNotification:[],error:null},I=C({name:`${f}/state`,initialState:F,reducers:{},extraReducers:n=>{n.addCase(c.fulfilled,(e,i)=>{e.dataNotification=i.payload,e.loading=!1}).addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.rejected,(e,i)=>{e.loading=!1,e.error=i.error.message||"Failed to fetch notifications"}).addCase(u.fulfilled,(e,i)=>{e.dataOneNotification=i.payload,e.loadingGetOne=!1}).addCase(u.pending,e=>{e.loadingGetOne=!0,e.error=null}).addCase(u.rejected,(e,i)=>{e.loadingGetOne=!1,e.error=i.error.message||"Failed to fetch notifications"})}}),L=I.reducer,b=G({data:L}),x=T;function _(n){return D({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 8a6 6 0 1 1 12 0v2.917c0 .703.228 1.387.65 1.95L20.7 15.6a1.5 1.5 0 0 1-1.2 2.4h-15a1.5 1.5 0 0 1-1.2-2.4l2.05-2.733a3.25 3.25 0 0 0 .65-1.95Zm6 13.5A3.502 3.502 0 0 1 8.645 19h6.71A3.502 3.502 0 0 1 12 21.5Z"},child:[]}]})(n)}N("notification",b);const $=({children:n,...e})=>a.jsx(w,{...e,size:25,shape:"circle",children:n});function M(){const n=j(),[e,i]=m.useState(null),d=x(t=>t.notification.data.dataNotification.data),A=x(t=>t.notification.data.loading),v=async t=>{try{const s=await B(t);s&&s.data.statusCode>=200&&s.data.statusCode<300?(n(c()),r.push(a.jsx(o,{title:"Berhasil Hapus Notifikasi",type:"success",duration:2500,children:"Notifikasi berhasil dihapus"}),{placement:"top-center"})):r.push(a.jsx(o,{title:"Gagal Hapus Notifikasi",type:"danger",duration:2500,children:s.data.message||"Terjadi kesalahan saat menghapus notifikasi"}),{placement:"top-center"})}catch(s){console.error("Error deleting notification:",s),r.push(a.jsx(o,{title:"Gagal Hapus Notifikasi",type:"danger",duration:2500,children:"Terjadi kesalahan saat menghapus notifikasi"}),{placement:"top-center"})}},h=async t=>{try{const s=await y(t);s&&s.statusCode>=200&&s.statusCode<300?(n(c()),r.push(a.jsx(o,{title:"Berhasil Tandai Dibaca",type:"success",duration:2500,children:"Notifikasi berhasil ditandai sebagai sudah dibaca"}),{placement:"top-center"})):r.push(a.jsx(o,{title:"Gagal Tandai Dibaca",type:"danger",duration:2500,children:s.data.message||"Terjadi kesalahan saat menandai notifikasi"}),{placement:"top-center"})}catch(s){console.error("Error marking notification as read:",s),r.push(a.jsx(o,{title:"Gagal Tandai Dibaca",type:"danger",duration:2500,children:"Terjadi kesalahan saat menandai notifikasi"}),{placement:"top-center"})}};return m.useEffect(()=>{n(c())},[location.pathname]),console.log("dataNotification",d),a.jsx(O,{loading:A,children:a.jsx("div",{children:d&&d.map((t,s)=>a.jsxs("div",{media:a.jsx($,{className:`text-white dark:text-gray-100
                                   ${t.type==="timeline"?"bg-amber-500":t.type==="adendum"?"bg-blue-500":t.type==="faktur_pajak"?"bg-green-500":""}
                                    `,children:a.jsx(_,{})}),className:`py-2 
                                ${s===0?"border-t":""}
                                ${e===t.id?"bg-slate-50":""}
                                    border-b hover:bg-slate-50 cursor-pointer pl-4`,onClick:()=>i(e===t.id?null:t.id),children:[a.jsxs("div",{className:"my-1 flex items-center",children:[a.jsx("sdivan",{className:"font-semibold text-gray-900 dark:text-gray-100",children:t.type}),a.jsx("span",{className:"mx-2",children:"diinfokan pada"}),a.jsxs("span",{className:"",children:[H(t.createdAt)," "]}),a.jsxs("div",{className:"flex flex-row ml-auto space-x-2 justify-center items-center",children:[t.status_baca===!1?a.jsx(l,{size:"xs",className:"flex items-center justify-center ml-auto",onClick:p=>{p.stopPropagation(),h(t)},children:"Tandai Dibaca"}):a.jsx(l,{size:"xs",className:"flex items-center justify-center ml-auto",onClick:p=>{p.stopPropagation(),h(t)},disabled:!0,children:"Sudah Dibaca"}),a.jsx(l,{type:"button",shape:"circle",variant:"plain",size:"sm",className:"text-red-500",icon:a.jsx(k,{}),onClick:()=>v(t)})]})]}),e===t.id&&a.jsxs("div",{className:"mt-8 mb-8 ",children:[a.jsx("p",{children:t.pesan}),t.type==="faktur_pajak"&&a.jsxs("div",{className:"mt-4 flex gap-3",children:[a.jsx(l,{size:"sm",className:"text-xs flex justify-center items-center",children:"Tolak Faktur"}),a.jsx(l,{size:"sm",className:"text-xs flex justify-center items-center",variant:"solid",children:"Setujui Faktur"})]}),t.type==="adendum"&&a.jsx("div",{className:"mt-4 flex",children:a.jsx(l,{variant:"solid",size:"sm",className:"text-xs flex justify-center items-center",children:"Lihat Adendum"})})]})]},t.id))})})}N("notification",b);function V(){const n=j(),e=async()=>{try{const i=await E();i&&i.data.statusCode>=200&&i.data.statusCode<300?(r.push(a.jsx(o,{title:"Berhasil Hapus Notifikasi",type:"success",duration:2500,children:"Semua notifikasi yang sudah dibaca berhasil dihapus"}),{placement:"top-center"}),n(c())):r.push(a.jsx(o,{title:"Gagal Hapus Notifikasi",type:"danger",duration:2500,children:i.data.message||"Terjadi kesalahan saat menghapus notifikasi"}),{placement:"top-center"})}catch(i){console.error("Error deleting notification:",i),r.push(a.jsx(o,{title:"Gagal Hapus Notifikasi",type:"danger",duration:2500,children:"Terjadi kesalahan saat menghapus notifikasi"}),{placement:"top-center"})}};return a.jsx(R,{children:a.jsx(S,{children:a.jsx("div",{className:"grid lg:grid-cols-5 gap-8",children:a.jsxs("div",{className:"col-span-4",children:[a.jsxs("div",{className:"flex flex-row justify-between",children:[a.jsx("h3",{className:"mb-6",children:"Semua Notifikasi"}),a.jsxs(l,{variant:"solid",size:"sm",className:"text-xs flex justify-center items-center",color:"red",onClick:()=>e(),children:[a.jsx(k,{className:"inline-block mr-2"}),"Bersihkan Notifikasi"]})]}),a.jsx(M,{})]})})})})}export{V as default};
