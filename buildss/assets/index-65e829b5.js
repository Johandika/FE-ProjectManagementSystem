import{ah as P,ai as M,aj as q,ak as G,a as j,j as e,r as b,a6 as B,L as v,al as V}from"./index-b009c0ac.js";import{b as $,f as K}from"./SubkontraktorService-16494bf1.js";import{C as _,A as Q}from"./ConfirmDialog-ac6f9f6d.js";import{D as W}from"./DataTable-1ce7dae1.js";import{t as J,N as U,w as X,H as Y,x as C,I as F,y as w,F as Z,z as f,am as k,R as S,B as g,E as ee,h as te,aF as ae,G as se}from"./Views-3aa30f3b.js";import{u as ne}from"./useThemeClass-c7400041.js";import{d as oe}from"./debounce-4e92db93.js";import{F as re,a as le,b as D}from"./formik.esm-e4f7a6c1.js";const L="subkontraktorList",p=P(L+"/getSubkontraktors",async t=>(await $(t)).data),ie=async t=>(await K(t)).data,T={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ce={loading:!1,deleteConfirmation:!1,selectedSubkontraktor:"",subkontraktorList:[],tableData:T,filterData:{name:"",category:["bags","cloths","devices","shoes","e"],status:[0,1,2],subkontraktorStatus:0}},I=M({name:`${L}/state`,initialState:ce,reducers:{updateSubkontraktorList:(t,a)=>{t.subkontraktorList=a.payload},setTableData:(t,a)=>{t.tableData=a.payload},setFilterData:(t,a)=>{t.filterData=a.payload},toggleDeleteConfirmation:(t,a)=>{t.deleteConfirmation=a.payload},setSelectedSubkontraktor:(t,a)=>{t.selectedSubkontraktor=a.payload}},extraReducers:t=>{t.addCase(p.fulfilled,(a,l)=>{a.subkontraktorList=l.payload.data,a.tableData.total=l.payload.total,a.loading=!1}).addCase(p.pending,a=>{a.loading=!0})}}),{updateSubkontraktorList:Te,setTableData:y,setFilterData:ue,toggleDeleteConfirmation:N,setSelectedSubkontraktor:de}=I.actions,me=I.reducer,ke=q({data:me}),h=G,be=()=>{const t=j(),a=h(c=>c.subkontraktorList.data.deleteConfirmation),l=h(c=>c.subkontraktorList.data.selectedSubkontraktor),u=h(c=>c.subkontraktorList.data.tableData),i=()=>{t(N(!1))},n=async()=>{t(N(!1)),await ie({id:l})&&(t(p(u)),J.push(e.jsx(U,{title:"Successfuly Deleted",type:"success",duration:2500,children:"Item berhasil dihapus"}),{placement:"top-center"}))};return e.jsx(_,{isOpen:a,type:"danger",title:"Hapus Subkontraktor",confirmButtonColor:"red-600",onClose:i,onRequestClose:i,onCancel:i,onConfirm:n,children:e.jsx("p",{children:"Apakah kamu yakin ingin menghapus subkontraktor ini?"})})},he=({row:t})=>{const a=j(),{textTheme:l}=ne(),u=B(),i=()=>{u(`/master/subkontraktor-edit/${t.id}`)},n=()=>{a(N(!0)),a(de(t.id))};return e.jsxs("div",{className:"flex justify-end text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${l}`,onClick:i,children:e.jsx(X,{})}),e.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:n,children:e.jsx(Y,{})})]})},xe=()=>{const t=b.useRef(null),a=j(),{pageIndex:l,pageSize:u,sort:i,query:n,total:c}=h(r=>r.subkontraktorList.data.tableData),s=h(r=>r.subkontraktorList.data.filterData),o=h(r=>r.subkontraktorList.data.loading),x=h(r=>r.subkontraktorList.data.subkontraktorList);b.useEffect(()=>{z()},[l,u,i]),b.useEffect(()=>{var r;t&&((r=t.current)==null||r.resetSorting())},[s]);const d=b.useMemo(()=>({pageIndex:l,pageSize:u,sort:i,query:n,total:c}),[l,u,i,n,c]),z=()=>{a(p({pageIndex:l,pageSize:u,sort:i,query:n,filterData:s}))},A=b.useMemo(()=>[{header:"Nama",accessorKey:"nama",cell:r=>{const m=r.row.original;return e.jsx("span",{className:"capitalize",children:m.nama})}},{header:"",id:"action",cell:r=>e.jsx(he,{row:r.row.original})}],[]),E=r=>{const m=C(d);m.pageIndex=r,a(y(m))},O=r=>{const m=C(d);m.pageSize=Number(r),m.pageIndex=1,a(y(m))},H=r=>{const m=C(d);m.sort=r,a(y(m))};return e.jsxs(e.Fragment,{children:[e.jsx(W,{ref:t,columns:A,data:x,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:o,pagingData:{total:d.total,pageIndex:d.pageIndex,pageSize:d.pageSize},onPaginationChange:E,onSelectChange:O,onSort:H}),e.jsx(be,{})]})},pe=()=>{const t=j(),a=b.useRef(null),l=h(s=>s.subkontraktorList.data.tableData),u=oe(i,500);function i(s){const o=C(l);o.query=s,o.pageIndex=1,typeof s=="string"&&s.length>1&&n(o),typeof s=="string"&&s.length===0&&n(o)}const n=s=>{t(y(s)),t(p(s))},c=s=>{u(s.target.value)};return e.jsx(F,{ref:a,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Cari subkontraktor",prefix:e.jsx(w,{className:"text-lg"}),onChange:c})},R=b.forwardRef(({onSubmitComplete:t},a)=>{const l=j(),u=h(n=>n.subkontraktorList.data.filterData),i=n=>{t==null||t(),l(ue(n)),l(p(T))};return e.jsx(re,{enableReinitialize:!0,innerRef:a,initialValues:u,onSubmit:n=>{i(n)},children:({values:n,touched:c,errors:s})=>e.jsx(le,{children:e.jsxs(Z,{children:[e.jsxs(f,{invalid:s.name&&c.name,errorMessage:s.name,children:[e.jsx("h6",{className:"mb-4",children:"Included text"}),e.jsx(D,{type:"text",autoComplete:"off",name:"name",placeholder:"Keyword",component:F,prefix:e.jsx(w,{className:"text-lg"})})]}),e.jsxs(f,{invalid:s.category&&c.category,errorMessage:s.category,children:[e.jsx("h6",{className:"mb-4",children:"Product Category"}),e.jsx(D,{name:"category",children:({field:o,form:x})=>e.jsx(e.Fragment,{children:e.jsxs(k.Group,{vertical:!0,value:n.category,onChange:d=>x.setFieldValue(o.name,d),children:[e.jsxs(k,{className:"mb-3",name:o.name,value:"bags",children:["Bags"," "]}),e.jsxs(k,{className:"mb-3",name:o.name,value:"cloths",children:["Cloths"," "]}),e.jsxs(k,{className:"mb-3",name:o.name,value:"devices",children:["Devices"," "]}),e.jsxs(k,{className:"mb-3",name:o.name,value:"shoes",children:["Shoes"," "]}),e.jsxs(k,{name:o.name,value:"watches",children:["Watches"," "]})]})})})]}),e.jsxs(f,{invalid:s.status&&c.status,errorMessage:s.status,children:[e.jsx("h6",{className:"mb-4",children:"Product Category"}),e.jsx(D,{name:"status",children:({field:o,form:x})=>e.jsx(e.Fragment,{children:e.jsxs(k.Group,{vertical:!0,value:n.status,onChange:d=>x.setFieldValue(o.name,d),children:[e.jsxs(k,{className:"mb-3",name:o.name,value:0,children:["In Stock"," "]}),e.jsxs(k,{className:"mb-3",name:o.name,value:1,children:["Limited"," "]}),e.jsxs(k,{className:"mb-3",name:o.name,value:2,children:["Out Of Stock"," "]})]})})})]}),e.jsxs(f,{invalid:s.subkontraktorStatus&&c.subkontraktorStatus,errorMessage:s.subkontraktorStatus,children:[e.jsx("h6",{className:"mb-4",children:"Product Status"}),e.jsx(D,{name:"subkontraktorStatus",children:({field:o,form:x})=>e.jsxs(S.Group,{vertical:!0,value:n.subkontraktorStatus,onChange:d=>x.setFieldValue(o.name,d),children:[e.jsx(S,{value:0,children:"Published"}),e.jsx(S,{value:1,children:"Disabled"}),e.jsx(S,{value:2,children:"Archive"})]})})]})]})})})}),ge=({onSaveClick:t,onCancel:a})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(g,{size:"sm",className:"mr-2",onClick:a,children:"Cancel"}),e.jsx(g,{size:"sm",variant:"solid",onClick:t,children:"Query"})]}),je=()=>{const t=b.useRef(null),[a,l]=b.useState(!1),u=()=>{l(!0)},i=()=>{l(!1)},n=()=>{var c;(c=t.current)==null||c.submitForm()};return e.jsxs(e.Fragment,{children:[e.jsx(g,{size:"sm",className:"block md:inline-block ltr:md:ml-2 rtl:md:mr-2 md:mb-0 mb-4",icon:e.jsx(ee,{}),onClick:()=>u(),children:"Filter"}),e.jsx(te,{title:"Filter",isOpen:a,footer:e.jsx(ge,{onCancel:i,onSaveClick:n}),onClose:i,onRequestClose:i,children:e.jsx(R,{ref:t,onSubmitComplete:i})})]})};R.displayName="FilterForm";const fe=()=>e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[e.jsx(pe,{}),e.jsx(je,{}),e.jsx(v,{download:!0,className:"block lg:inline-block md:mx-2 md:mb-0 mb-4",to:"/data/product-list.csv",target:"_blank",children:e.jsx(g,{block:!0,size:"sm",icon:e.jsx(ae,{}),children:"Export"})}),e.jsx(v,{className:"block lg:inline-block md:mb-0 mb-4",to:"/master/subkontraktor-new",children:e.jsx(g,{block:!0,variant:"solid",size:"sm",icon:e.jsx(se,{}),children:"Tambah Subkontraktor"})})]});V("subkontraktorList",ke);const Se=()=>e.jsxs(Q,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Daftar Subkontraktor"}),e.jsx(fe,{})]}),e.jsx(xe,{})]}),Ie=Se;export{Ie as default};
