import{r as T,j as a,V as z}from"./index-b009c0ac.js";import{z as h,I as _,C as X,W as q,am as E,B as D,aD as U,aE as W,x as aa,F as ea,H as sa}from"./Views-3aa30f3b.js";import{S as la}from"./StickyFooter-132dd9b0.js";import{A as Q,C as na}from"./ConfirmDialog-ac6f9f6d.js";import{b as c,c as G,u as ia,F as ta,a as ra}from"./formik.esm-e4f7a6c1.js";import{N as V}from"./react-number-format.es-92e434c6.js";import{a as ma}from"./index-7729926c.js";import{c as Z,a as A}from"./index.esm-0e511974.js";const oa=M=>{const{touched:g,errors:i,type:x,kliensList:j=[]}=M,[N,y]=T.useState(!1),b=(l,t)=>{console.log(y(l)),t.setFieldValue("is_retensi",l),l||(t.setFieldValue("persen_retensi",0),t.setFieldValue("jatuh_tempo_retensi",null))};return a.jsxs(Q,{divider:!0,className:"mb-4",children:[a.jsx("h5",{children:"Informasi Dasar"}),a.jsx("p",{className:"mb-6",children:"Sesi untuk mengatur informasi dasar proyek"}),a.jsx(h,{label:"Pekerjaan",invalid:i.pekerjaan&&g.pekerjaan,errorMessage:i.pekerjaan,children:a.jsx(c,{type:"text",autoComplete:"off",name:"pekerjaan",placeholder:"Nama pekerjaan",component:_})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-4",children:[a.jsx("div",{className:"col-span-1",children:a.jsx(h,{label:"Klien",invalid:i.idClient&&g.idClient,errorMessage:i.idClient,children:a.jsx(c,{name:"idClient",children:({field:l,form:t})=>{const e=l.value?j.find(m=>m.id===l.value):null,s=j.map(m=>({value:m.id,label:`${m.nama}`}));return a.jsx(X,{field:l,form:t,options:s,value:e?{value:e.nama,label:`${e.nama}`}:null,placeholder:"Pilih klien",onChange:m=>{t.setFieldValue(l.name,m==null?void 0:m.value)}})}})})}),a.jsx("div",{className:"col-span-1",children:a.jsx(h,{label:"Nomor Kontrak",invalid:i.nomor_kontrak&&g.nomor_kontrak,errorMessage:i.nomor_kontrak,children:a.jsx(c,{type:"text",autoComplete:"off",name:"nomor_kontrak",placeholder:"Nomor Kontrak",component:_})})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-4",children:[a.jsx("div",{className:"col-span-1",children:a.jsx(h,{label:"Tanggal Kontrak",invalid:i.tanggal_kontrak&&g.tanggal_kontrak,errorMessage:i.tanggal_kontrak,children:a.jsx(c,{name:"tanggal_kontrak",children:({field:l,form:t})=>a.jsx(q,{placeholder:"Pilih Tanggal",value:l.value?new Date(l.value):null,inputFormat:"DD-MM-YYYY",onChange:e=>{const s=e?z(e).format("YYYY-MM-DD"):"";t.setFieldValue(l.name,s)}})})})}),a.jsx("div",{className:"col-span-1",children:a.jsx(h,{label:"Nilai Kontrak",invalid:i.nilai_kontrak&&g.nilai_kontrak,errorMessage:i.nilai_kontrak,children:a.jsx(c,{name:"nilai_kontrak",children:({field:l,form:t})=>a.jsx(V,{...l,customInput:_,placeholder:"Nilai Kontrak",thousandSeparator:".",decimalSeparator:",",onValueChange:e=>{t.setFieldValue(l.name,e.value)}})})})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-4",children:[x==="new"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(h,{label:"Timeline Awal",invalid:i.timeline_awal&&g.timeline_awal,errorMessage:i.timeline_awal,children:a.jsx(c,{name:"timeline_awal",children:({field:l,form:t})=>a.jsx(q,{placeholder:"Pilih Tanggal",value:l.value?new Date(l.value):null,inputFormat:"DD-MM-YYYY",onChange:e=>{const s=e?z(e).format("YYYY-MM-DD"):"";t.setFieldValue(l.name,s)}})})})}),a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(h,{label:"Timeline Akhir",invalid:i.timeline_akhir&&g.timeline_akhir,errorMessage:i.timeline_akhir,children:a.jsx(c,{name:"timeline_akhir",children:({field:l,form:t})=>a.jsx(q,{placeholder:"Pilih Tanggal",value:l.value?new Date(l.value):null,inputFormat:"DD-MM-YYYY",onChange:e=>{const s=e?z(e).format("YYYY-MM-DD"):"";t.setFieldValue(l.name,s)}})})})})]}),a.jsx("div",{className:"col-span-1",children:a.jsx(h,{label:"PIC",invalid:i.pic&&g.pic,errorMessage:i.pic,children:a.jsx(c,{type:"text",autoComplete:"off",name:"pic",placeholder:"Person in charge",component:_})})}),x==="new"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(h,{label:"Uang Muka",invalid:i.uang_muka&&g.uang_muka,errorMessage:i.uang_muka,children:a.jsx(c,{name:"uang_muka",children:({field:l,form:t})=>a.jsx(V,{...l,customInput:_,placeholder:"Uang Muka",thousandSeparator:".",decimalSeparator:",",onValueChange:e=>{t.setFieldValue(l.name,e.value)}})})})}),a.jsx("div",{className:"col-span-2 ",children:a.jsx(c,{name:"is_retensi",children:({form:l})=>a.jsx(E,{checked:N,onChange:t=>b(t,l),children:"Retensi"})})}),N&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(h,{label:"Persen Retensi (%)",invalid:i.persen_retensi&&g.persen_retensi,errorMessage:i.persen_retensi,children:a.jsx(c,{name:"persen_retensi",children:({field:l,form:t})=>a.jsx(V,{...l,customInput:_,placeholder:"0",onValueChange:e=>{t.setFieldValue(l.name,e.value)}})})})}),a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(h,{label:"Jatuh Tempo Retensi",invalid:i.jatuh_tempo_retensi&&g.jatuh_tempo_retensi,errorMessage:i.jatuh_tempo_retensi,children:a.jsx(c,{name:"jatuh_tempo_retensi",children:({field:l,form:t})=>a.jsx(q,{placeholder:"Pilih Tanggal",value:l.value?new Date(l.value):null,inputFormat:"DD-MM-YYYY",onChange:e=>{const s=e?z(e).format("YYYY-MM-DD"):"";t.setFieldValue(l.name,s)}})})})})]})]}),a.jsx("div",{className:"col-span-2",children:a.jsx(h,{label:"Keterangan",labelClass:"!justify-start",invalid:i.keterangan&&g.keterangan,errorMessage:i.keterangan,children:a.jsx(c,{textArea:!0,name:"keterangan",placeholder:"Masukkan keterangan",component:_})})})]})]})},ua=M=>{const{touched:g,errors:i}=M;return a.jsxs(Q,{divider:!0,className:"mb-4",children:[a.jsx("h5",{children:"Lokasi Proyek"}),a.jsx("p",{className:"mb-6",children:"Tambahkan lokasi-lokasi proyek yang terkait"}),a.jsx(G,{name:"lokasi",children:({push:x,remove:j,form:N})=>{const{values:y}=N,{lokasi:b=[]}=y;return a.jsxs("div",{children:[b.map((l,t)=>{var o,F,C,Y,$,P,H,O,u,n,d,J,L,v;const e=(o=i.lokasi)==null?void 0:o[t],s=(F=g.lokasi)==null?void 0:F[t],m=(e==null?void 0:e.lokasi)&&(s==null?void 0:s.lokasi),r=(e==null?void 0:e.latitude)&&(s==null?void 0:s.latitude),k=(e==null?void 0:e.longitude)&&(s==null?void 0:s.longitude);return a.jsxs("div",{className:"mb-4 border rounded-md p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("h6",{children:["Lokasi ",t+1]}),a.jsx(D,{type:"button",shape:"circle",variant:"plain",size:"sm",icon:a.jsx(U,{}),onClick:p=>{p.preventDefault(),p.stopPropagation(),j(t)}})]}),a.jsx("div",{className:"mb-3",children:a.jsx(h,{className:"w-full mb-0",label:"Nama Lokasi",invalid:!!m,errorMessage:typeof((Y=(C=i.lokasi)==null?void 0:C[t])==null?void 0:Y.lokasi)=="string"?(P=($=i.lokasi)==null?void 0:$[t])==null?void 0:P.lokasi:"",children:a.jsx(c,{type:"text",autoComplete:"off",name:`lokasi[${t}].lokasi`,placeholder:"Nama lokasi",component:_})})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(h,{className:"mb-0",label:"Latitude",invalid:!!r,errorMessage:typeof((O=(H=i.lokasi)==null?void 0:H[t])==null?void 0:O.latitude)=="string"?(n=(u=i.lokasi)==null?void 0:u[t])==null?void 0:n.latitude:"",children:a.jsx(c,{type:"number",step:"0.0001",autoComplete:"off",name:`lokasi[${t}].latitude`,placeholder:"contoh: -6.2088",component:_})}),a.jsx(h,{className:"mb-0",label:"Longitude",invalid:!!k,errorMessage:typeof((J=(d=i.lokasi)==null?void 0:d[t])==null?void 0:J.longitude)=="string"?(v=(L=i.lokasi)==null?void 0:L[t])==null?void 0:v.longitude:"",children:a.jsx(c,{type:"number",step:"0.0001",autoComplete:"off",name:`lokasi[${t}].longitude`,placeholder:"contoh: 106.8456",component:_})})]})]},t)}),a.jsx(D,{type:"button",variant:"twoTone",icon:a.jsx(W,{}),onClick:()=>x({lokasi:"",latitude:0,longitude:0}),children:"Tambah Lokasi"})]})}})]})},ca=M=>{const{touched:g,errors:i,terminsList:x=[]}=M,{values:j,setFieldValue:N}=ia();T.useEffect(()=>{if(x&&x.length>0){const b=x.map((l,t)=>({keterangan:l.keterangan||`Termin ${t+1}`,persen:l.persen}));N("termin",b)}},[x,N]);const y=T.useMemo(()=>!j.termin||!Array.isArray(j.termin)?0:j.termin.reduce((b,l)=>{const t=parseFloat(String(l.persen))||0;return b+t},0),[j.termin]);return a.jsxs(Q,{divider:!0,className:"mb-4",children:[a.jsx("h5",{children:"Termin Pembayaran"}),a.jsx("p",{className:"mb-6",children:"Tambahkan data termin pembayaran beserta persentasenya"}),a.jsx(G,{name:"termin",children:({push:b,remove:l})=>a.jsxs("div",{children:[j.termin&&j.termin.length>0&&a.jsxs("div",{className:"flex mb-2",children:[a.jsx("div",{className:"flex-grow mr-4",children:a.jsx("p",{className:"font-medium",children:"Keterangan"})}),a.jsx("div",{className:"w-32",children:a.jsx("p",{className:"font-medium",children:"Persentase (%)"})}),a.jsx("div",{className:"w-10"})]}),j.termin&&j.termin.map((t,e)=>{var k,o,F,C,Y,$,P,H,O,u,n,d,J,L,v,p;const s=`Termin ${e+1}`;j.termin[e].keterangan!==s&&N(`termin[${e}].keterangan`,s);const m=((o=(k=i.termin)==null?void 0:k[e])==null?void 0:o.keterangan)&&((C=(F=g.termin)==null?void 0:F[e])==null?void 0:C.keterangan),r=(($=(Y=i.termin)==null?void 0:Y[e])==null?void 0:$.persen)&&((H=(P=g.termin)==null?void 0:P[e])==null?void 0:H.persen);return a.jsxs("div",{className:"flex items-start mb-4",children:[a.jsxs(h,{className:"flex-grow mb-0 mr-4",invalid:!!m,errorMessage:typeof((u=(O=i.termin)==null?void 0:O[e])==null?void 0:u.keterangan)=="string"?(d=(n=i.termin)==null?void 0:n[e])==null?void 0:d.keterangan:"",children:[a.jsx(_,{type:"text",value:s,disabled:!0,readOnly:!0,className:"bg-gray-100"}),a.jsx(c,{type:"hidden",name:`termin[${e}].keterangan`,value:s})]}),a.jsx(h,{className:"w-32 mb-0 mr-2",invalid:!!r,errorMessage:typeof((L=(J=i.termin)==null?void 0:J[e])==null?void 0:L.persen)=="string"?(p=(v=i.termin)==null?void 0:v[e])==null?void 0:p.persen:"",children:a.jsx(c,{name:`termin[${e}].persen`,children:({field:f,form:S})=>a.jsx(V,{...f,customInput:_,placeholder:"%",suffix:"%",onValueChange:w=>{S.setFieldValue(f.name,Number(w.value))}})})}),a.jsx("div",{className:"flex items-center h-10",children:a.jsx(D,{type:"button",shape:"circle",variant:"plain",size:"sm",icon:a.jsx(U,{}),onClick:f=>{f.preventDefault(),f.stopPropagation(),l(e)}})})]},e)}),j.termin&&j.termin.length>0&&a.jsx("div",{className:"flex justify-end mb-4",children:a.jsxs("div",{className:"w-32 mr-12",children:[a.jsxs("div",{className:`font-medium ${y!==100?"text-red-500":"text-emerald-500"}`,children:["Total: ",y,"%"]}),y!==100&&a.jsx("div",{className:"text-xs text-red-500",children:"Total harus 100%"})]})}),a.jsx(D,{type:"button",variant:"twoTone",icon:a.jsx(W,{}),onClick:()=>b({keterangan:"",persen:0}),children:"Tambah Termin"})]})})]})},{DatePickerRange:ha}=q,da=M=>{const{touched:g,errors:i,subkontraktorsList:x=[]}=M;return a.jsxs(Q,{divider:!0,className:"mb-4",children:[a.jsx("h5",{children:"Subkontraktor"}),a.jsx("p",{className:"mb-6",children:"Tambahkan detail subkontraktor proyek"}),a.jsx(G,{name:"subkontraktor",children:({push:j,remove:N,form:y})=>{const{values:b}=y,{subkontraktor:l=[]}=b;return a.jsxs("div",{children:[l.map((t,e)=>{var r,k;const s=(r=i.subkontraktor)==null?void 0:r[e],m=(k=g.subkontraktor)==null?void 0:k[e];return a.jsxs("div",{className:"mb-4 border rounded-md p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("h6",{children:["Subkontraktor ",e+1]}),a.jsx(D,{type:"button",shape:"circle",variant:"plain",size:"sm",icon:a.jsx(U,{}),onClick:o=>{o.preventDefault(),o.stopPropagation(),N(e)}})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[a.jsx(h,{className:"w-full mb-0",label:"Nomor Surat",invalid:(s==null?void 0:s.nomor_surat)&&(m==null?void 0:m.nomor_surat),errorMessage:s==null?void 0:s.nomor_surat,children:a.jsx(c,{type:"text",autoComplete:"off",name:`subkontraktor[${e}].nomor_surat`,placeholder:"Nomor surat subkontraktor",component:_})}),a.jsx(h,{label:"Nama Vendor Subkon",className:"w-full mb-0",invalid:(s==null?void 0:s.id)&&(m==null?void 0:m.id),errorMessage:s==null?void 0:s.id,children:a.jsx(c,{name:`subkontraktor[${e}].id`,children:({field:o,form:F})=>{const C=o.value?x.find($=>$.id===o.value):null,Y=x.map($=>({value:$.id,label:`${$.nama}`}));return a.jsx(X,{field:o,form:F,options:Y,value:C?{value:C.id,label:`${C.nama}`}:null,placeholder:"Pilih subkontraktor",onChange:$=>{const P=$?$.value:"";F.setFieldValue(o.name,P)}})}})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[a.jsx(h,{className:"mb-0",label:"Nilai Subkon",invalid:(s==null?void 0:s.nilai_subkontrak)&&(m==null?void 0:m.nilai_subkontrak),errorMessage:s==null?void 0:s.nilai_subkontrak,children:a.jsx(c,{name:`subkontraktor[${e}].nilai_subkontrak`,children:({field:o,form:F})=>a.jsx(V,{...o,customInput:_,placeholder:"Nilai kontrak subkontraktor",thousandSeparator:".",decimalSeparator:",",onValueChange:C=>{F.setFieldValue(o.name,C.value)}})})}),a.jsx(h,{className:"mb-0",label:"Waktu Pelaksanaan Kerja",invalid:(s==null?void 0:s.waktu_mulai_pelaksanaan)&&(m==null?void 0:m.waktu_mulai_pelaksanaan)||(s==null?void 0:s.waktu_selesai_pelaksanaan)&&(m==null?void 0:m.waktu_selesai_pelaksanaan),errorMessage:(s==null?void 0:s.waktu_mulai_pelaksanaan)||(s==null?void 0:s.waktu_selesai_pelaksanaan),children:a.jsx(ha,{placeholder:"Pilih rentang waktu",value:[l[e].waktu_mulai_pelaksanaan?new Date(l[e].waktu_mulai_pelaksanaan):null,l[e].waktu_selesai_pelaksanaan?new Date(l[e].waktu_selesai_pelaksanaan):null],singleDate:!1,closePickerOnChange:!1,onChange:o=>{if(o[0]!==null&&o[1]!==null){const F=z(o[0]).format("YYYY-MM-DD"),C=z(o[1]).format("YYYY-MM-DD");y.setFieldValue(`subkontraktor[${e}].waktu_mulai_pelaksanaan`,F),y.setFieldValue(`subkontraktor[${e}].waktu_selesai_pelaksanaan`,C)}}})})]}),a.jsx(h,{className:"mb-0",label:"Keterangan",invalid:(s==null?void 0:s.keterangan)&&(m==null?void 0:m.keterangan),errorMessage:s==null?void 0:s.keterangan,children:a.jsx(c,{type:"text",autoComplete:"off",name:`subkontraktor[${e}].keterangan`,placeholder:"Keterangan pekerjaan subkontraktor",component:_})})]},e)}),a.jsx(D,{type:"button",variant:"twoTone",icon:a.jsx(W,{}),onClick:()=>j({id:"",nomor_surat:"",nilai_subkontrak:"",waktu_mulai_pelaksanaan:"",waktu_selesai_pelaksanaan:"",keterangan:""}),children:"Tambah Subkontraktor"})]})}})]})},ja=M=>{const{touched:g,errors:i,satuansList:x=[]}=M,j=(b,l)=>b*l,N=(b,l)=>b*l,y=(b,l)=>b+l;return a.jsxs(Q,{divider:!0,className:"mb-4",children:[a.jsx("h5",{children:"RAB"}),a.jsx("p",{className:"mb-6",children:"Tambahkan RAB untuk proyek ini"}),a.jsx(G,{name:"item",children:({push:b,remove:l,form:t})=>{const{values:e}=t,{item:s=[]}=e;return a.jsxs("div",{children:[s.map((m,r)=>{var F,C;const k=(F=i.item)==null?void 0:F[r],o=(C=g.item)==null?void 0:C[r];return a.jsxs("div",{className:"mb-6 border rounded-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h6",{className:"text-base font-semibold",children:["Item ",r+1]}),a.jsx(D,{type:"button",shape:"circle",variant:"plain",size:"sm",icon:a.jsx(U,{}),onClick:()=>l(r)})]}),a.jsx(h,{label:"Nama Item",invalid:(k==null?void 0:k.item)&&(o==null?void 0:o.item),errorMessage:k==null?void 0:k.item,className:"mb-4",children:a.jsx(c,{type:"text",autoComplete:"off",name:`item[${r}].item`,placeholder:"Nama RAB",component:_})}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md mb-4",children:[a.jsx("h6",{className:"mb-2",children:"Detail Item"}),a.jsx(G,{name:`item[${r}].detail`,children:({push:Y,remove:$})=>{var H;const P=((H=s[r])==null?void 0:H.detail)||[];return a.jsxs("div",{children:[P.map((O,u)=>{var J,L;const n=(J=k==null?void 0:k.detail)==null?void 0:J[u],d=(L=o==null?void 0:o.detail)==null?void 0:L[u];return a.jsxs("div",{className:"mb-4 border border-dashed rounded-md p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("h6",{children:["Detail"," ",u+1]}),a.jsx(D,{type:"button",shape:"circle",variant:"plain",size:"sm",icon:a.jsx(U,{}),onClick:()=>$(u)})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[a.jsx(h,{className:"mb-0",label:"Uraian",invalid:(n==null?void 0:n.uraian)&&(d==null?void 0:d.uraian),errorMessage:n==null?void 0:n.uraian,children:a.jsx(c,{type:"text",autoComplete:"off",name:`item[${r}].detail[${u}].uraian`,placeholder:"Uraian pekerjaan",component:_})}),a.jsx(h,{className:"mb-0",label:"Satuan",invalid:(n==null?void 0:n.satuan)&&(d==null?void 0:d.satuan),errorMessage:n==null?void 0:n.satuan,children:a.jsx(c,{name:`item[${r}].detail[${u}].idSatuan`,children:({field:v,form:p})=>{const f=v.value?x.find(w=>w.id===v.value):null,S=x.map(w=>({value:w.id,label:`${w.satuan}`}));return console.log("selectedSatuan",f),a.jsx(X,{field:v,form:p,options:S,value:f?{value:f.satuan,label:`${f.satuan}`}:null,placeholder:"Pilih satuan",onChange:w=>{p.setFieldValue(v.name,w==null?void 0:w.value)}})}})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3",children:[a.jsx(h,{className:"mb-0",label:"Volume",invalid:(n==null?void 0:n.volume)&&(d==null?void 0:d.volume),errorMessage:n==null?void 0:n.volume,children:a.jsx(c,{name:`item[${r}].detail[${u}].volume`,children:({field:v,form:p})=>a.jsx(V,{...v,customInput:_,placeholder:"Volume",thousandSeparator:".",decimalSeparator:",",onValueChange:f=>{const S=Number(f.value);p.setFieldValue(v.name,S);const w=p.values.item[r].detail[u].harga_satuan_material||0,B=p.values.item[r].detail[u].harga_satuan_jasa||0,R=j(S,w),K=N(S,B),I=y(R,K);p.setFieldValue(`item[${r}].detail[${u}].jumlah_harga_material`,R),p.setFieldValue(`item[${r}].detail[${u}].jumlah_harga_jasa`,K),p.setFieldValue(`item[${r}].detail[${u}].jumlah`,I)}})})}),a.jsx(h,{className:"mb-0",label:"Harga Satuan Material",invalid:(n==null?void 0:n.harga_satuan_material)&&(d==null?void 0:d.harga_satuan_material),errorMessage:n==null?void 0:n.harga_satuan_material,children:a.jsx(c,{name:`item[${r}].detail[${u}].harga_satuan_material`,children:({field:v,form:p})=>a.jsx(V,{...v,customInput:_,placeholder:"Harga satuan material",thousandSeparator:".",decimalSeparator:",",onValueChange:f=>{const S=Number(f.value);p.setFieldValue(v.name,S);const w=p.values.item[r].detail[u].volume||0,B=j(w,S),R=p.values.item[r].detail[u].jumlah_harga_jasa||0,K=y(B,R);p.setFieldValue(`item[${r}].detail[${u}].jumlah_harga_material`,B),p.setFieldValue(`item[${r}].detail[${u}].jumlah`,K)}})})}),a.jsx(h,{className:"mb-0",label:"Harga Satuan Jasa",invalid:(n==null?void 0:n.harga_satuan_jasa)&&(d==null?void 0:d.harga_satuan_jasa),errorMessage:n==null?void 0:n.harga_satuan_jasa,children:a.jsx(c,{name:`item[${r}].detail[${u}].harga_satuan_jasa`,children:({field:v,form:p})=>a.jsx(V,{...v,customInput:_,placeholder:"Harga satuan jasa",thousandSeparator:".",decimalSeparator:",",onValueChange:f=>{const S=Number(f.value);p.setFieldValue(v.name,S);const w=p.values.item[r].detail[u].volume||0,B=N(w,S),R=p.values.item[r].detail[u].jumlah_harga_material||0,K=y(R,B);p.setFieldValue(`item[${r}].detail[${u}].jumlah_harga_jasa`,B),p.setFieldValue(`item[${r}].detail[${u}].jumlah`,K)}})})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(h,{className:"mb-0",label:"Jumlah Harga Material",invalid:(n==null?void 0:n.jumlah_harga_material)&&(d==null?void 0:d.jumlah_harga_material),errorMessage:n==null?void 0:n.jumlah_harga_material,children:a.jsx(c,{name:`item[${r}].detail[${u}].jumlah_harga_material`,children:({field:v})=>a.jsx(V,{...v,customInput:_,placeholder:"Jumlah harga material",thousandSeparator:".",decimalSeparator:",",readOnly:!0,disabled:!0})})}),a.jsx(h,{className:"mb-0",label:"Jumlah Harga Jasa",invalid:(n==null?void 0:n.jumlah_harga_jasa)&&(d==null?void 0:d.jumlah_harga_jasa),errorMessage:n==null?void 0:n.jumlah_harga_jasa,children:a.jsx(c,{name:`item[${r}].detail[${u}].jumlah_harga_jasa`,children:({field:v})=>a.jsx(V,{...v,customInput:_,placeholder:"Jumlah harga jasa",thousandSeparator:".",decimalSeparator:",",readOnly:!0,disabled:!0})})}),a.jsx(h,{className:"mb-0",label:"Jumlah Total",invalid:(n==null?void 0:n.jumlah)&&(d==null?void 0:d.jumlah),errorMessage:n==null?void 0:n.jumlah,children:a.jsx(c,{name:`item[${r}].detail[${u}].jumlah`,children:({field:v})=>a.jsx(V,{...v,customInput:_,placeholder:"Jumlah total",thousandSeparator:".",decimalSeparator:",",readOnly:!0,disabled:!0})})})]})]},u)}),a.jsx(D,{type:"button",variant:"twoTone",className:"ml-4",size:"sm",icon:a.jsx(W,{}),onClick:()=>Y({uraian:"",idSatuan:"",volume:0,harga_satuan_material:0,harga_satuan_jasa:0,jumlah_harga_material:0,jumlah_harga_jasa:0,jumlah:0}),children:"Tambah Detail"})]})}})]})]},r)}),a.jsx(D,{type:"button",variant:"twoTone",icon:a.jsx(W,{}),onClick:()=>b({item:"",detail:[{uraian:"",idSatuan:"",volume:0,harga_satuan_material:0,harga_satuan_jasa:0,jumlah_harga_material:0,jumlah_harga_jasa:0,jumlah:0}]}),children:"Tambah RAB"})]})}})]})},pa=Z().shape({pekerjaan:A().required("Pekerjaan wajib diisi"),timeline_awal:A().required("Timeline awal wajib diisi"),timeline_akhir:A().required("Timeline akhir wajib diisi"),idClient:A().required("Klien wajib diisi"),pic:A().required("PIC wajib diisi")}),ga=Z().shape({pekerjaan:A().required("Pekerjaan wajib diisi"),idClient:A().required("Klien wajib diisi"),pic:A().required("PIC wajib diisi")}),ka=({onDelete:M})=>{const[g,i]=T.useState(!1),x=()=>{i(!0)},j=()=>{i(!1)},N=()=>{M==null||M(i)};return a.jsxs(a.Fragment,{children:[a.jsx(D,{className:"text-red-600",variant:"plain",size:"sm",icon:a.jsx(sa,{}),type:"button",onClick:x,children:"Hapus"}),a.jsx(na,{isOpen:g,type:"danger",title:"Hapus proyek",confirmButtonColor:"red-600",onClose:j,onRequestClose:j,onCancel:j,onConfirm:N,children:a.jsx("p",{children:"Apakah Anda yakin ingin menghapus proyek ini?"})})]})},va=T.forwardRef((M,g)=>{const{type:i,initialData:x={pekerjaan:"",pic:"",nomor_kontrak:"",timeline_awal:"",timeline_akhir:"",tanggal_service_po:"",tanggal_kontrak:"",is_retensi:!1,persen_retensi:0,jatuh_tempo_retensi:null,tanggal_delivery:"",nilai_kontrak:0,uang_muka:0,timeline:0,keterangan:"",idClient:"",berkas:[],item:[],lokasi:[],termin:[],subkontraktor:[]},initialDataEdit:j={pekerjaan:"",pic:"",nomor_kontrak:"",tanggal_service_po:"",tanggal_kontrak:"",tanggal_delivery:"",nilai_kontrak:0,timeline:0,keterangan:"",idClient:""},onFormSubmit:N,onDiscard:y,onDelete:b,kliensList:l=[],berkasesList:t=[],satuansList:e=[],subkontraktorsList:s=[],terminsList:m=[]}=M;return a.jsx(a.Fragment,{children:a.jsx(ta,{innerRef:g,initialValues:i==="new"?{...x}:{...j},validationSchema:i==="new"?pa:ga,onSubmit:(r,{setSubmitting:k})=>{const o=aa(r);N==null||N(o,k)},children:({touched:r,errors:k,isSubmitting:o})=>a.jsx(ra,{children:a.jsxs(ea,{children:[a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:a.jsxs("div",{className:"lg:col-span-2",children:[a.jsx(oa,{type:i,touched:r,errors:k,kliensList:l,berkasesList:t}),i==="new"&&a.jsxs(a.Fragment,{children:[a.jsx(ua,{touched:r,errors:k}),a.jsx(da,{touched:r,errors:k,subkontraktorsList:s.length>0?s:[]}),a.jsx(ja,{touched:r,errors:k,satuansList:e}),a.jsx(ca,{touched:r,errors:k,terminsList:m})]})]})}),a.jsxs(la,{className:"-mx-8 px-8 flex items-center justify-between py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[a.jsx("div",{children:i==="edit"&&a.jsx(ka,{onDelete:b})}),a.jsxs("div",{className:"md:flex items-center",children:[a.jsx(D,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:()=>y==null?void 0:y(),children:"Batal"}),a.jsx(D,{size:"sm",variant:"solid",loading:o,icon:a.jsx(ma,{}),type:"submit",children:"Simpan"})]})]})]})})})})});va.displayName="ProyekForm";export{va as P};
