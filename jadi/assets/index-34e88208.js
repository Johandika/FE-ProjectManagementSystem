import{ai as A,aj as R,ak as E,al as F,r as d,u as T,j as a,S as O,i as q}from"./index-8f324225.js";import{c as W}from"./TagihanService-6b2a78dc.js";import{A as G}from"./AdaptableCard-54b628e2.js";import{D as M}from"./DataTable-66df47f9.js";import{a5 as $,B,J as x,K as H,L as J}from"./Views-a6cda74e.js";import{a as P}from"./formatDate-07efb40a.js";import{d as Q}from"./debounce-9aa8ee7b.js";import"./index-fee04496.js";const N="tagihanProyekList",u=A(N+"/getTagihanProyeks",async n=>{const t=await W(n);return{data:t.data.data,total:t.data.totalData,totalPage:t.data.totalPage}}),U={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},V={loading:!1,loadingGetTagihanProyek:!1,deleteConfirmation:!1,selectedProduct:"",proyeksList:[],tagihanData:[],tableData:U,filterData:{name:"",category:["bags","cloths","devices","shoes","d"],status:[0,1,2],productStatus:0}},S=R({name:`${N}/state`,initialState:V,reducers:{updateProyeksList:(n,t)=>{n.proyeksList=t.payload},setTableData:(n,t)=>{n.tableData=t.payload},setFilterData:(n,t)=>{n.filterData=t.payload},toggleDeleteConfirmation:(n,t)=>{n.deleteConfirmation=t.payload},setSelectedProduct:(n,t)=>{n.selectedProduct=t.payload}},extraReducers:n=>{n.addCase(u.fulfilled,(t,l)=>{t.proyeksList=l.payload.data,t.tableData.total=l.payload.total,t.tableData.totalPage=l.payload.totalPage,t.loading=!1}).addCase(u.pending,t=>{t.loading=!0})}}),{updateProyeksList:ga,setTableData:m,setFilterData:ha,toggleDeleteConfirmation:pa,setSelectedProduct:xa}=S.actions,X=S.reducer,Y=E({data:X}),p=F,Z=()=>{var D,b;const n=d.useRef(null),t=T(),[l,f]=d.useState(!1),{pageIndex:g,pageSize:r,sort:h,query:o,total:i}=p(e=>e.tagihanProyekList.data.tableData),j=p(e=>e.tagihanProyekList.data.filterData),{loading:w,loadingGetTagihanProyek:L}=p(e=>e.tagihanProyekList.data),C=p(e=>e.tagihanProyekList.data.proyeksList),y=p(e=>e.tagihanProyekList.data.tagihanData);d.useEffect(()=>{v()},[g,r,h]),d.useEffect(()=>{var e;n&&((e=n.current)==null||e.resetSorting())},[j]);const c=d.useMemo(()=>({pageIndex:g,pageSize:r,sort:h,query:o,total:i}),[g,r,h,o,i]),v=()=>{t(u({pageIndex:g,pageSize:r,sort:h,query:o,filterData:j}))},k=()=>{f(!1)},I=d.useMemo(()=>[{header:"Pekerjaan",accessorKey:"pekerjaan",row:100,minWidth:350,cell:e=>{const s=e.row.original;return a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("div",{className:"text-blue-600 text-xs font-semibold capitalize",children:s.nomor_kontrak}),a.jsxs("div",{className:"text-base font-medium text-neutral-800",children:[s.idTender&&a.jsx("span",{className:"bg-emerald-100 text-emerald-600 w-[20px] h-[20px] px-[6px] py-[2px]  mr-2 text-xs font-semibold rounded-md",children:"Tender"}),s.pekerjaan]}),a.jsx("div",{className:"text-blue-600 text-xs font-semibold",children:s.pic})]})}},{header:"Nilai Kontrak",accessorKey:"nilai_kontrak",minWidth:150,cell:e=>{const s=e.row.original;return a.jsx("span",{className:"capitalize",children:s.nilai_kontrak.toLocaleString("id-ID")})}},{header:"Total Tagihan",accessorKey:"total_tagihan",minWidth:150,cell:e=>{const s=e.row.original;return a.jsx("span",{className:"capitalize",children:s.total_tagihan.toLocaleString("id-ID")})}},{header:"Tanggal Kontrak",accessorKey:"tanggal_kontrak",minWidth:150,cell:e=>{const s=e.row.original;return a.jsx("span",{className:"capitalize",children:P(s.tanggal_kontrak)})}}],[]),_=e=>{const s=x(c);s.pageIndex=e,t(m(s))},z=e=>{const s=x(c);s.pageSize=Number(e),s.pageIndex=1,t(m(s))},K=e=>{const s=x(c);s.sort=e,t(m(s))};return a.jsxs(a.Fragment,{children:[a.jsx(M,{ref:n,columns:I,data:C,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:w,pagingData:{total:c.total,pageIndex:c.pageIndex,pageSize:c.pageSize,totalPage:c.totalPage},onPaginationChange:_,onSelectChange:z,onSort:K}),a.jsx($,{isOpen:l,width:1e3,onClose:k,onRequestClose:k,children:a.jsxs("div",{className:"flex flex-col h-full justify-between",children:[a.jsx("h5",{className:"mb-4",children:"Detail Daftar Tagihan"}),a.jsx("div",{className:"overflow-y-auto bg-slate-50",children:L?a.jsx("div",{className:"flex justify-center items-center ",children:a.jsx(O,{size:100})}):a.jsx("div",{className:" max-h-[50vh] ml-6",children:((D=y.tagihan_details)==null?void 0:D.length)>0?(b=y.tagihan_details)==null?void 0:b.map((e,s)=>a.jsxs("div",{className:"flex flex-row my-2 py-4 border-b gap-2",children:[a.jsx("div",{children:a.jsx("strong",{children:`${s+1}.`})}),a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Pekekrjaan:"})," ",e.pekerjaan]}),a.jsxs("p",{children:[a.jsx("strong",{children:"PIC:"})," ",e.pic]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Nomor Kontrak:"})," ",e.nomor_kontrak]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Nliai Kontrak:"})," ",e.nilai_kontrak.toLocaleString("id-ID")]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Nominal Tagihan:"})," ",e.nominal_tagihan.toLocaleString("id-ID")]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Tanggal Kontrak:"})," ",P(e.tanggal_kontrak)]})]})]},e.id)):a.jsx("div",{children:"Tidak ada detail tagihan"})})}),a.jsx("div",{className:"text-right mt-6",children:a.jsx(B,{variant:"solid",onClick:k,children:"OK"})})]})})]})},aa=()=>{const n=T(),t=d.useRef(null),l=p(o=>o.tagihanProyekList.data.tableData),f=Q(g,500);function g(o){const i=x(l);i.query=o,i.pageIndex=1,typeof o=="string"&&o.length>1&&r(i),typeof o=="string"&&o.length===0&&r(i)}const r=o=>{n(m(o)),n(u(o))},h=o=>{f(o.target.value)};return a.jsx(H,{ref:t,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Cari tagihanProyek",prefix:a.jsx(J,{className:"text-lg"}),onChange:h})},ea=()=>a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center",children:a.jsx(aa,{})});q("tagihanProyekList",Y);const ta=()=>a.jsxs(G,{className:"h-full",bodyClass:"h-full",children:[a.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"mb-4 lg:mb-0",children:"Daftar Tagihan Proyek"}),a.jsx(ea,{})]}),a.jsx(Z,{})]}),ma=ta;export{ma as default};
