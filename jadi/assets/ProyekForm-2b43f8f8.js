import{r as K,j as a,W as U,a9 as aa}from"./index-8f324225.js";import{F as d,K as y,w as T,x as W,aD as ea,B as V,aV as G,aW as Q,ad as z,J as sa,P as la,H as na}from"./Views-a6cda74e.js";import{S as ia}from"./StickyFooter-e17b8275.js";import{C as ta}from"./ConfirmDialog-cacab1ef.js";import{b as h,c as X,u as ra,F as ma,a as oa}from"./formik.esm-79e86e67.js";import{A as Z}from"./AdaptableCard-54b628e2.js";import{N as Y}from"./react-number-format.es-53214375.js";import{a as ua}from"./index-7235128c.js";import{c as I,a as A}from"./index.esm-02ea902b.js";const ca=M=>{const{touched:v,errors:t,type:o,kliensList:j=[],initialData:f={},dataDivisi:C}=M,[x,_]=K.useState(!1),[k,r]=K.useState(!1),l=(e,s)=>{s.setFieldValue("is_retensi",e),e||(s.setFieldValue("persen_retensi",0),s.setFieldValue("jatuh_tempo_retensi",null))};return K.useEffect(()=>{var e;((e=f==null?void 0:f.idClient)==null?void 0:e.length)>5&&r(!0)},[f]),a.jsxs(Z,{divider:!0,className:"mb-4",children:[a.jsx("h5",{children:"Informasi Dasar"}),a.jsx("p",{className:"mb-6",children:"Sesi untuk mengatur informasi dasar proyek"}),a.jsx(d,{label:"Pekerjaan",invalid:t.pekerjaan&&v.pekerjaan,errorMessage:t.pekerjaan,children:a.jsx(h,{type:"text",autoComplete:"off",name:"pekerjaan",placeholder:"Nama pekerjaan",component:y,disabled:k})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-4",children:[a.jsx("div",{className:"col-span-1",children:a.jsx(d,{label:"Klien",invalid:t.idClient&&v.idClient,errorMessage:t.idClient,children:a.jsx(h,{name:"idClient",children:({field:e,form:s})=>{const n=e.value?j.find(u=>u.id===e.value):null,m=j.map(u=>({value:u.id,label:`${u.nama}`}));return a.jsx(T,{field:e,form:s,isDisabled:k,options:m,value:n?{value:n.nama,label:`${n.nama}`}:null,placeholder:"Pilih klien",onChange:u=>{s.setFieldValue(e.name,u==null?void 0:u.value)}})}})})}),a.jsx("div",{className:"col-span-1",children:a.jsx(d,{label:"Nomor Kontrak",invalid:t.nomor_kontrak&&v.nomor_kontrak,errorMessage:t.nomor_kontrak,children:a.jsx(h,{type:"text",autoComplete:"off",name:"nomor_kontrak",placeholder:"Nomor Kontrak",component:y})})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-4",children:[a.jsx("div",{className:"col-span-1",children:a.jsx(d,{label:"Tanggal Kontrak",invalid:t.tanggal_kontrak&&v.tanggal_kontrak,errorMessage:t.tanggal_kontrak,children:a.jsx(h,{name:"tanggal_kontrak",children:({field:e,form:s})=>a.jsx(W,{placeholder:"Pilih Tanggal",value:e.value?new Date(e.value):null,inputFormat:"DD-MM-YYYY",onChange:n=>{const m=n?U(n).format("YYYY-MM-DD"):"";s.setFieldValue(e.name,m)}})})})}),a.jsx("div",{className:"col-span-1",children:a.jsx(d,{label:"Nilai Kontrak",invalid:t.nilai_kontrak&&v.nilai_kontrak,errorMessage:t.nilai_kontrak,children:a.jsx(h,{name:"nilai_kontrak",children:({field:e,form:s})=>a.jsx(Y,{...e,customInput:y,disabled:k,placeholder:"Nilai Kontrak",thousandSeparator:".",decimalSeparator:",",onValueChange:n=>{s.setFieldValue(e.name,n.value)}})})})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-4",children:[o==="new"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(d,{label:"Timeline Awal",invalid:t.timeline_awal&&v.timeline_awal,errorMessage:t.timeline_awal,children:a.jsx(h,{name:"timeline_awal",children:({field:e,form:s})=>a.jsx(W,{placeholder:"Pilih Tanggal",value:e.value?new Date(e.value):null,inputFormat:"DD-MM-YYYY",onChange:n=>{const m=n?U(n).format("YYYY-MM-DD"):"";s.setFieldValue(e.name,m)}})})})}),a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(d,{label:"Timeline Akhir",invalid:t.timeline_akhir&&v.timeline_akhir,errorMessage:t.timeline_akhir,children:a.jsx(h,{name:"timeline_akhir",children:({field:e,form:s})=>a.jsx(W,{placeholder:"Pilih Tanggal",value:e.value?new Date(e.value):null,inputFormat:"DD-MM-YYYY",onChange:n=>{const m=n?U(n).format("YYYY-MM-DD"):"";s.setFieldValue(e.name,m)}})})})})]}),a.jsx("div",{className:"col-span-1",children:a.jsx(d,{label:"PIC",invalid:t.pic&&v.pic,errorMessage:t.pic,children:a.jsx(h,{type:"text",autoComplete:"off",name:"pic",placeholder:"Person in charge",component:y,style:{textTransform:"uppercase"}})})}),o==="new"&&a.jsx(a.Fragment,{children:a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(d,{label:"Uang Muka",invalid:t.uang_muka&&v.uang_muka,errorMessage:t.uang_muka,children:a.jsx(h,{name:"uang_muka",children:({field:e,form:s})=>a.jsx(Y,{...e,customInput:y,placeholder:"Uang Muka",thousandSeparator:".",decimalSeparator:",",onValueChange:n=>{s.setFieldValue(e.name,n.value)}})})})})}),a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(d,{label:"Divisi",invalid:t.idDivisi&&v.idDivisi,errorMessage:t.idDivisi,children:a.jsx(h,{name:"idDivisi",children:({field:e,form:s})=>a.jsx(T,{placeholder:"Pilih divisi",isDisabled:k,options:C==null?void 0:C.map(n=>({label:n.name,value:n.id})),value:C==null?void 0:C.map(n=>({label:n.name,value:n.id})).find(n=>n.value===e.value),onChange:n=>{s.setFieldValue(e.name,(n==null?void 0:n.value)||"")}})})})}),o==="new"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"col-span-2 ",children:a.jsx(h,{name:"is_retensi",children:({form:e})=>a.jsx(ea,{checked:x,onChange:s=>l(s,e),children:"Retensi"})})}),x&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(d,{label:"Persen Retensi (%)",invalid:t.persen_retensi&&v.persen_retensi,errorMessage:t.persen_retensi,children:a.jsx(h,{name:"persen_retensi",children:({field:e,form:s})=>a.jsx(Y,{...e,customInput:y,placeholder:"0",onValueChange:n=>{s.setFieldValue(e.name,n.value)}})})})}),a.jsx("div",{className:"col-span-2 md:col-span-1",children:a.jsx(d,{label:"Jatuh Tempo Retensi",invalid:t.jatuh_tempo_retensi&&v.jatuh_tempo_retensi,errorMessage:t.jatuh_tempo_retensi,children:a.jsx(h,{name:"jatuh_tempo_retensi",children:({field:e,form:s})=>a.jsx(W,{placeholder:"Pilih Tanggal",value:e.value?new Date(e.value):null,inputFormat:"DD-MM-YYYY",onChange:n=>{const m=n?U(n).format("YYYY-MM-DD"):"";s.setFieldValue(e.name,m)}})})})})]})]}),a.jsx("div",{className:"col-span-2",children:a.jsx(d,{label:"Keterangan",labelClass:"!justify-start",invalid:t.keterangan&&v.keterangan,errorMessage:t.keterangan,children:a.jsx(h,{textArea:!0,name:"keterangan",placeholder:"Masukkan keterangan",component:y})})})]})]})},ha=M=>{const{touched:v,errors:t}=M;return a.jsxs(Z,{divider:!0,className:"mb-4",children:[a.jsx("h5",{children:"Lokasi Proyek"}),a.jsx("p",{className:"mb-6",children:"Tambahkan lokasi-lokasi proyek yang terkait"}),a.jsx(X,{name:"lokasi",children:({push:o,remove:j,form:f})=>{const{values:C}=f,{lokasi:x=[]}=C;return a.jsxs("div",{children:[x.map((_,k)=>{var m,u,N,S,$,P,H,O,c,i,p,J,L,b;const r=(m=t.lokasi)==null?void 0:m[k],l=(u=v.lokasi)==null?void 0:u[k],e=(r==null?void 0:r.lokasi)&&(l==null?void 0:l.lokasi),s=(r==null?void 0:r.latitude)&&(l==null?void 0:l.latitude),n=(r==null?void 0:r.longitude)&&(l==null?void 0:l.longitude);return a.jsxs("div",{className:"mb-4 border rounded-md p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("h6",{children:["Lokasi ",k+1]}),a.jsx(V,{type:"button",shape:"circle",variant:"plain",size:"sm",icon:a.jsx(G,{}),onClick:g=>{g.preventDefault(),g.stopPropagation(),j(k)}})]}),a.jsx("div",{className:"mb-3",children:a.jsx(d,{className:"w-full mb-0",label:"Nama Lokasi",invalid:!!e,errorMessage:typeof((S=(N=t.lokasi)==null?void 0:N[k])==null?void 0:S.lokasi)=="string"?(P=($=t.lokasi)==null?void 0:$[k])==null?void 0:P.lokasi:"",children:a.jsx(h,{type:"text",autoComplete:"off",name:`lokasi[${k}].lokasi`,placeholder:"Nama lokasi",component:y})})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(d,{className:"mb-0",label:"Latitude",invalid:!!s,errorMessage:typeof((O=(H=t.lokasi)==null?void 0:H[k])==null?void 0:O.latitude)=="string"?(i=(c=t.lokasi)==null?void 0:c[k])==null?void 0:i.latitude:"",children:a.jsx(h,{type:"number",step:"0.0001",autoComplete:"off",name:`lokasi[${k}].latitude`,placeholder:"contoh: -6.2088",component:y})}),a.jsx(d,{className:"mb-0",label:"Longitude",invalid:!!n,errorMessage:typeof((J=(p=t.lokasi)==null?void 0:p[k])==null?void 0:J.longitude)=="string"?(b=(L=t.lokasi)==null?void 0:L[k])==null?void 0:b.longitude:"",children:a.jsx(h,{type:"number",step:"0.0001",autoComplete:"off",name:`lokasi[${k}].longitude`,placeholder:"contoh: 106.8456",component:y})})]})]},k)}),a.jsx(V,{type:"button",variant:"twoTone",icon:a.jsx(Q,{}),onClick:()=>o({lokasi:"",latitude:0,longitude:0}),children:"Tambah Lokasi"})]})}})]})},da=M=>{const{touched:v,errors:t,terminsList:o=[]}=M,{values:j,setFieldValue:f}=ra();K.useEffect(()=>{if(o&&o.length>0){const x=o.map((_,k)=>({keterangan:_.keterangan||`Termin ${k+1}`,persen:_.persen}));f("termin",x)}},[o,f]);const C=K.useMemo(()=>!j.termin||!Array.isArray(j.termin)?0:j.termin.reduce((x,_)=>{const k=parseFloat(String(_.persen))||0;return x+k},0),[j.termin]);return a.jsxs(Z,{divider:!0,className:"mb-4",children:[a.jsx("h5",{children:"Termin Pembayaran"}),a.jsx("p",{className:"mb-6",children:"Tambahkan data termin pembayaran beserta persentasenya"}),a.jsx(X,{name:"termin",children:({push:x,remove:_})=>a.jsxs("div",{children:[j.termin&&j.termin.length>0&&a.jsxs("div",{className:"flex mb-2",children:[a.jsx("div",{className:"flex-grow mr-4",children:a.jsx("p",{className:"font-medium",children:"Keterangan"})}),a.jsx("div",{className:"w-32",children:a.jsx("p",{className:"font-medium",children:"Persentase (%)"})}),a.jsx("div",{className:"w-10"})]}),j.termin&&j.termin.map((k,r)=>{var n,m,u,N,S,$,P,H,O,c,i,p,J,L,b,g;const l=`Termin ${r+1}`;j.termin[r].keterangan!==l&&f(`termin[${r}].keterangan`,l);const e=((m=(n=t.termin)==null?void 0:n[r])==null?void 0:m.keterangan)&&((N=(u=v.termin)==null?void 0:u[r])==null?void 0:N.keterangan),s=(($=(S=t.termin)==null?void 0:S[r])==null?void 0:$.persen)&&((H=(P=v.termin)==null?void 0:P[r])==null?void 0:H.persen);return a.jsxs("div",{className:"flex items-start mb-4",children:[a.jsxs(d,{className:"flex-grow mb-0 mr-4",invalid:!!e,errorMessage:typeof((c=(O=t.termin)==null?void 0:O[r])==null?void 0:c.keterangan)=="string"?(p=(i=t.termin)==null?void 0:i[r])==null?void 0:p.keterangan:"",children:[a.jsx(y,{type:"text",value:l,disabled:!0,readOnly:!0,className:"bg-gray-100"}),a.jsx(h,{type:"hidden",name:`termin[${r}].keterangan`,value:l})]}),a.jsx(d,{className:"w-32 mb-0 mr-2",invalid:!!s,errorMessage:typeof((L=(J=t.termin)==null?void 0:J[r])==null?void 0:L.persen)=="string"?(g=(b=t.termin)==null?void 0:b[r])==null?void 0:g.persen:"",children:a.jsx(h,{name:`termin[${r}].persen`,children:({field:D,form:F})=>a.jsx(Y,{...D,customInput:y,placeholder:"%",suffix:"%",onValueChange:w=>{F.setFieldValue(D.name,Number(w.value))}})})}),a.jsx("div",{className:"flex items-center h-10",children:a.jsx(V,{type:"button",shape:"circle",variant:"plain",size:"sm",icon:a.jsx(G,{}),onClick:D=>{D.preventDefault(),D.stopPropagation(),_(r)}})})]},r)}),j.termin&&j.termin.length>0&&a.jsx("div",{className:"flex justify-end mb-4",children:a.jsxs("div",{className:"w-32 mr-12",children:[a.jsxs("div",{className:`font-medium ${C!==100?"text-red-500":"text-emerald-500"}`,children:["Total: ",C,"%"]}),C!==100&&a.jsx("div",{className:"text-xs text-red-500",children:"Total harus 100%"})]})}),a.jsx(V,{type:"button",variant:"twoTone",icon:a.jsx(Q,{}),onClick:()=>x({keterangan:"",persen:0}),children:"Tambah Termin"})]})})]})},{DatePickerRange:ja}=W,pa=M=>{const{touched:v,errors:t,subkontraktorsList:o=[]}=M;return a.jsxs(Z,{divider:!0,className:"mb-4",children:[a.jsx("h5",{children:"Subkontraktor"}),a.jsx("p",{className:"mb-6",children:"Tambahkan detail subkontraktor proyek"}),a.jsx(X,{name:"subkontraktor",children:({push:j,remove:f,form:C})=>{const{values:x}=C,{subkontraktor:_=[]}=x;return a.jsxs("div",{children:[_.map((k,r)=>{var s,n;const l=(s=t.subkontraktor)==null?void 0:s[r],e=(n=v.subkontraktor)==null?void 0:n[r];return a.jsxs("div",{className:"mb-4 border rounded-md p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("h6",{children:["Subkontraktor ",r+1]}),a.jsx(V,{type:"button",shape:"circle",variant:"plain",size:"sm",icon:a.jsx(G,{}),onClick:m=>{m.preventDefault(),m.stopPropagation(),f(r)}})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[a.jsx(d,{className:"w-full mb-0",label:"Nomor Surat",invalid:(l==null?void 0:l.nomor_surat)&&(e==null?void 0:e.nomor_surat),errorMessage:l==null?void 0:l.nomor_surat,children:a.jsx(h,{type:"text",autoComplete:"off",name:`subkontraktor[${r}].nomor_surat`,placeholder:"Nomor surat subkontraktor",component:y})}),a.jsx(d,{label:"Nama Vendor Subkon",className:"w-full mb-0",invalid:(l==null?void 0:l.id)&&(e==null?void 0:e.id),errorMessage:l==null?void 0:l.id,children:a.jsx(h,{name:`subkontraktor[${r}].id`,children:({field:m,form:u})=>{const N=m.value?o.find($=>$.id===m.value):null,S=o.map($=>({value:$.id,label:`${$.nama}`}));return a.jsx(T,{field:m,form:u,options:S,value:N?{value:N.id,label:`${N.nama}`}:null,placeholder:"Pilih subkontraktor",onChange:$=>{const P=$?$.value:"";u.setFieldValue(m.name,P)}})}})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[a.jsx(d,{className:"mb-0",label:"Nilai Subkon",invalid:(l==null?void 0:l.nilai_subkontrak)&&(e==null?void 0:e.nilai_subkontrak),errorMessage:l==null?void 0:l.nilai_subkontrak,children:a.jsx(h,{name:`subkontraktor[${r}].nilai_subkontrak`,children:({field:m,form:u})=>a.jsx(Y,{...m,customInput:y,placeholder:"Nilai kontrak subkontraktor",thousandSeparator:".",decimalSeparator:",",onValueChange:N=>{u.setFieldValue(m.name,N.value)}})})}),a.jsx(d,{className:"mb-0",label:"Waktu Pelaksanaan Kerja",invalid:(l==null?void 0:l.waktu_mulai_pelaksanaan)&&(e==null?void 0:e.waktu_mulai_pelaksanaan)||(l==null?void 0:l.waktu_selesai_pelaksanaan)&&(e==null?void 0:e.waktu_selesai_pelaksanaan),errorMessage:(l==null?void 0:l.waktu_mulai_pelaksanaan)||(l==null?void 0:l.waktu_selesai_pelaksanaan),children:a.jsx(ja,{placeholder:"Pilih rentang waktu",value:[_[r].waktu_mulai_pelaksanaan?new Date(_[r].waktu_mulai_pelaksanaan):null,_[r].waktu_selesai_pelaksanaan?new Date(_[r].waktu_selesai_pelaksanaan):null],singleDate:!1,closePickerOnChange:!1,onChange:m=>{if(m[0]!==null&&m[1]!==null){const u=U(m[0]).format("YYYY-MM-DD"),N=U(m[1]).format("YYYY-MM-DD");C.setFieldValue(`subkontraktor[${r}].waktu_mulai_pelaksanaan`,u),C.setFieldValue(`subkontraktor[${r}].waktu_selesai_pelaksanaan`,N)}}})})]}),a.jsx(d,{className:"mb-0",label:"Keterangan",invalid:(l==null?void 0:l.keterangan)&&(e==null?void 0:e.keterangan),errorMessage:l==null?void 0:l.keterangan,children:a.jsx(h,{type:"text",autoComplete:"off",name:`subkontraktor[${r}].keterangan`,placeholder:"Keterangan pekerjaan subkontraktor",component:y})})]},r)}),a.jsx(V,{type:"button",variant:"twoTone",icon:a.jsx(Q,{}),onClick:()=>j({id:"",nomor_surat:"",nilai_subkontrak:"",waktu_mulai_pelaksanaan:"",waktu_selesai_pelaksanaan:"",keterangan:""}),children:"Tambah Subkontraktor"})]})}})]})},ka=M=>{const{touched:v,errors:t,satuansList:o=[]}=M,j=(x,_)=>z(x)*z(_),f=(x,_)=>z(x)*z(_),C=(x,_)=>z(x)+z(_);return a.jsxs(Z,{divider:!0,className:"mb-4",children:[a.jsx("h5",{children:"RAB"}),a.jsx("p",{className:"mb-6",children:"Tambahkan RAB untuk proyek ini"}),a.jsx(X,{name:"item",children:({push:x,remove:_,form:k})=>{const{values:r}=k,{item:l=[]}=r;return a.jsxs("div",{children:[l.map((e,s)=>{var u,N;const n=(u=t.item)==null?void 0:u[s],m=(N=v.item)==null?void 0:N[s];return a.jsxs("div",{className:"mb-6 border rounded-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h6",{className:"text-base font-semibold",children:["Item ",s+1]}),a.jsx(V,{type:"button",shape:"circle",variant:"plain",size:"sm",icon:a.jsx(G,{}),onClick:()=>_(s)})]}),a.jsx(d,{label:"Nama Item",invalid:(n==null?void 0:n.item)&&(m==null?void 0:m.item),errorMessage:n==null?void 0:n.item,className:"mb-4",children:a.jsx(h,{type:"text",autoComplete:"off",name:`item[${s}].item`,placeholder:"Nama RAB",component:y})}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md mb-4",children:[a.jsx("h6",{className:"mb-2",children:"Detail Item"}),a.jsx(X,{name:`item[${s}].detail`,children:({push:S,remove:$})=>{var H;const P=((H=l[s])==null?void 0:H.detail)||[];return a.jsxs("div",{children:[P.map((O,c)=>{var J,L;const i=(J=n==null?void 0:n.detail)==null?void 0:J[c],p=(L=m==null?void 0:m.detail)==null?void 0:L[c];return a.jsxs("div",{className:"mb-4 border border-dashed rounded-md p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("h6",{children:["Detail"," ",c+1]}),a.jsx(V,{type:"button",shape:"circle",variant:"plain",size:"sm",icon:a.jsx(G,{}),onClick:()=>$(c)})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[a.jsx(d,{className:"mb-0",label:"Uraian",invalid:(i==null?void 0:i.uraian)&&(p==null?void 0:p.uraian),errorMessage:i==null?void 0:i.uraian,children:a.jsx(h,{type:"text",autoComplete:"off",name:`item[${s}].detail[${c}].uraian`,placeholder:"Uraian pekerjaan",component:y})}),a.jsx(d,{className:"mb-0",label:"Satuan",invalid:(i==null?void 0:i.satuan)&&(p==null?void 0:p.satuan),errorMessage:i==null?void 0:i.satuan,children:a.jsx(h,{name:`item[${s}].detail[${c}].idSatuan`,children:({field:b,form:g})=>{const D=b.value?o.find(w=>w.id===b.value):null,F=o.map(w=>({value:w.id,label:`${w.satuan}`}));return a.jsx(T,{field:b,form:g,options:F,value:D?{value:D.satuan,label:`${D.satuan}`}:null,placeholder:"Pilih satuan",onChange:w=>{g.setFieldValue(b.name,w==null?void 0:w.value)}})}})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[a.jsx(d,{className:"mb-0",label:"Harga Satuan Material",invalid:(i==null?void 0:i.harga_satuan_material)&&(p==null?void 0:p.harga_satuan_material),errorMessage:i==null?void 0:i.harga_satuan_material,children:a.jsx(h,{name:`item[${s}].detail[${c}].harga_satuan_material`,children:({field:b,form:g})=>a.jsx(Y,{...b,customInput:y,placeholder:"Harga satuan material",thousandSeparator:".",decimalSeparator:",",onValueChange:D=>{const F=Number(D.value);g.setFieldValue(b.name,F);const w=g.values.item[s].detail[c].volume||0,B=j(w,F),R=g.values.item[s].detail[c].jumlah_harga_jasa||0,q=C(B,R);g.setFieldValue(`item[${s}].detail[${c}].jumlah_harga_material`,B),g.setFieldValue(`item[${s}].detail[${c}].jumlah`,q)}})})}),a.jsx(d,{className:"mb-0",label:"Jumlah Harga Material",invalid:(i==null?void 0:i.jumlah_harga_material)&&(p==null?void 0:p.jumlah_harga_material),errorMessage:i==null?void 0:i.jumlah_harga_material,children:a.jsx(h,{name:`item[${s}].detail[${c}].jumlah_harga_material`,children:({field:b})=>a.jsx(Y,{...b,customInput:y,placeholder:"Jumlah harga material",thousandSeparator:".",decimalSeparator:",",readOnly:!0,disabled:!0})})}),a.jsx(d,{className:"mb-0",label:"Harga Satuan Jasa",invalid:(i==null?void 0:i.harga_satuan_jasa)&&(p==null?void 0:p.harga_satuan_jasa),errorMessage:i==null?void 0:i.harga_satuan_jasa,children:a.jsx(h,{name:`item[${s}].detail[${c}].harga_satuan_jasa`,children:({field:b,form:g})=>a.jsx(Y,{...b,customInput:y,placeholder:"Harga satuan jasa",thousandSeparator:".",decimalSeparator:",",onValueChange:D=>{const F=Number(D.value);g.setFieldValue(b.name,F);const w=g.values.item[s].detail[c].volume||0,B=f(w,F),R=g.values.item[s].detail[c].jumlah_harga_material||0,q=C(R,B);g.setFieldValue(`item[${s}].detail[${c}].jumlah_harga_jasa`,B),g.setFieldValue(`item[${s}].detail[${c}].jumlah`,q)}})})}),a.jsx(d,{className:"mb-0",label:"Jumlah Harga Jasa",invalid:(i==null?void 0:i.jumlah_harga_jasa)&&(p==null?void 0:p.jumlah_harga_jasa),errorMessage:i==null?void 0:i.jumlah_harga_jasa,children:a.jsx(h,{name:`item[${s}].detail[${c}].jumlah_harga_jasa`,children:({field:b})=>a.jsx(Y,{...b,customInput:y,placeholder:"Jumlah harga jasa",thousandSeparator:".",decimalSeparator:",",readOnly:!0,disabled:!0})})}),a.jsx(d,{className:"mb-0",label:"Volume",invalid:(i==null?void 0:i.volume)&&(p==null?void 0:p.volume),errorMessage:i==null?void 0:i.volume,children:a.jsx(h,{name:`item[${s}].detail[${c}].volume`,children:({field:b,form:g})=>a.jsx(Y,{...b,customInput:y,placeholder:"Volume",thousandSeparator:".",decimalSeparator:",",onValueChange:D=>{const F=Number(D.value);g.setFieldValue(b.name,F);const w=g.values.item[s].detail[c].harga_satuan_material||0,B=g.values.item[s].detail[c].harga_satuan_jasa||0,R=j(F,w),q=f(F,B),E=C(R,q);g.setFieldValue(`item[${s}].detail[${c}].jumlah_harga_material`,R),g.setFieldValue(`item[${s}].detail[${c}].jumlah_harga_jasa`,q),g.setFieldValue(`item[${s}].detail[${c}].jumlah`,E)}})})}),a.jsx(d,{className:"mb-0",label:"Total",invalid:(i==null?void 0:i.jumlah)&&(p==null?void 0:p.jumlah),errorMessage:i==null?void 0:i.jumlah,children:a.jsx(h,{name:`item[${s}].detail[${c}].jumlah`,children:({field:b})=>a.jsx(Y,{...b,customInput:y,placeholder:"Jumlah total",thousandSeparator:".",decimalSeparator:",",readOnly:!0,disabled:!0})})})]})]},c)}),a.jsx(V,{type:"button",variant:"twoTone",className:"ml-4",size:"sm",icon:a.jsx(Q,{}),onClick:()=>S({uraian:"",idSatuan:"",volume:0,harga_satuan_material:0,harga_satuan_jasa:0,jumlah_harga_material:0,jumlah_harga_jasa:0,jumlah:0}),children:"Tambah Detail"})]})}})]})]},s)}),a.jsx(V,{type:"button",variant:"twoTone",icon:a.jsx(Q,{}),onClick:()=>x({item:"",detail:[{uraian:"",idSatuan:"",volume:0,harga_satuan_material:0,harga_satuan_jasa:0,jumlah_harga_material:0,jumlah_harga_jasa:0,jumlah:0}]}),children:"Tambah RAB"})]})}})]})},ga=I().shape({pekerjaan:A().required("Pekerjaan wajib diisi"),timeline_awal:A().required("Timeline awal wajib diisi"),timeline_akhir:A().required("Timeline akhir wajib diisi"),idClient:A().required("Klien wajib diisi"),pic:A().required("PIC wajib diisi")}),va=I().shape({pekerjaan:A().required("Pekerjaan wajib diisi"),idClient:A().required("Klien wajib diisi"),pic:A().required("PIC wajib diisi")}),_a=({onDelete:M})=>{const[v,t]=K.useState(!1),o=()=>{t(!0)},j=()=>{t(!1)},f=()=>{M==null||M(t)};return a.jsxs(a.Fragment,{children:[a.jsx(V,{className:"text-red-600",variant:"plain",size:"sm",icon:a.jsx(na,{}),type:"button",onClick:o,children:"Hapus"}),a.jsx(ta,{isOpen:v,type:"danger",title:"Hapus proyek",confirmButtonColor:"red-600",onClose:j,onRequestClose:j,onCancel:j,onConfirm:f,children:a.jsx("p",{children:"Apakah Anda yakin ingin menghapus proyek ini?"})})]})},ba=K.forwardRef((M,v)=>{const o=aa().state,{type:j,initialData:f={pekerjaan:(o==null?void 0:o.pekerjaan)||"",nilai_kontrak:(o==null?void 0:o.nilai_kontrak)||0,idClient:(o==null?void 0:o.idClient)||"",idDivisi:(o==null?void 0:o.idDivisi)||"",idTender:(o==null?void 0:o.idTender)||null,pic:"",nomor_kontrak:"",timeline_awal:"",timeline_akhir:"",tanggal_service_po:"",tanggal_kontrak:"",is_retensi:!1,persen_retensi:0,jatuh_tempo_retensi:null,tanggal_delivery:"",uang_muka:0,timeline:0,keterangan:"",berkas:[],item:[],lokasi:[],termin:[],subkontraktor:[]},initialDataEdit:C={pekerjaan:"",pic:"",nomor_kontrak:"",tanggal_service_po:"",tanggal_kontrak:"",tanggal_delivery:"",nilai_kontrak:0,timeline:0,keterangan:"",idClient:"",idDivisi:""},onFormSubmit:x,onDiscard:_,onDelete:k,dataDivisi:r=[],kliensList:l=[],berkasesList:e=[],satuansList:s=[],subkontraktorsList:n=[],terminsList:m=[]}=M;return a.jsx(a.Fragment,{children:a.jsx(ma,{innerRef:v,initialValues:j==="new"?{...f}:{...C},validationSchema:j==="new"?ga:va,onSubmit:(u,{setSubmitting:N})=>{const S=sa(u);x==null||x(S,N)},children:({touched:u,errors:N,isSubmitting:S})=>a.jsx(oa,{children:a.jsxs(la,{children:[a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:a.jsxs("div",{className:"lg:col-span-2",children:[a.jsx(ca,{type:j,touched:u,errors:N,kliensList:l,berkasesList:e,dataDivisi:r,initialData:f}),j==="new"&&a.jsxs(a.Fragment,{children:[a.jsx(ha,{touched:u,errors:N}),a.jsx(pa,{touched:u,errors:N,subkontraktorsList:n.length>0?n:[]}),a.jsx(ka,{touched:u,errors:N,satuansList:s}),a.jsx(da,{touched:u,errors:N,terminsList:m})]})]})}),a.jsxs(ia,{className:"-mx-8 px-8 flex items-center justify-between py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[a.jsx("div",{children:j==="edit"&&a.jsx(_a,{onDelete:k})}),a.jsxs("div",{className:"md:flex items-center",children:[a.jsx(V,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:()=>_==null?void 0:_(),children:"Batal"}),a.jsx(V,{size:"sm",variant:"solid",loading:S,icon:a.jsx(ua,{}),type:"submit",children:"Simpan"})]})]})]})})})})});ba.displayName="ProyekForm";export{ba as P};
