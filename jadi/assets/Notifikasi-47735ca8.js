import{u as k,a7 as B,r as u,j as a,am as F,i as y}from"./index-8f324225.js";import{A as U}from"./AdaptableCard-54b628e2.js";import{A as G,a as H,B as o,H as b,t as s,N as i,av as E,b3 as z}from"./Views-a6cda74e.js";import"./SvgIcon-d3af2c92.js";import{C as N}from"./ConfirmDialog-cacab1ef.js";import"./DataTable-66df47f9.js";import{u as g,g as h,s as j,c as R,d as P,r as C,b as _}from"./index-ac527888.js";import{f as $}from"./formatDate-07efb40a.js";import"./useThemeClass-fe409b1f.js";import"./index-fee04496.js";y("notification",C);function q(){const n=k(),f=B(),[p,c]=u.useState(!1),[r,l]=u.useState(null),[m,S]=u.useState(null),d=g(e=>e.notification.data.dataNotification.data),v=g(e=>e.notification.data.loading),D=async e=>{try{const t=await R(e);t&&t.data.statusCode>=200&&t.data.statusCode<300?(n(h()),s.push(a.jsx(i,{title:"Berhasil Hapus Notifikasi",type:"success",duration:2500,children:"Notifikasi berhasil dihapus"}),{placement:"top-center"})):s.push(a.jsx(i,{title:"Gagal Hapus Notifikasi",type:"danger",duration:2500,children:t.data.message||"Terjadi kesalahan saat menghapus notifikasi"}),{placement:"top-center"})}catch(t){console.error("Error deleting notification:",t),s.push(a.jsx(i,{title:"Gagal Hapus Notifikasi",type:"danger",duration:2500,children:"Terjadi kesalahan saat menghapus notifikasi"}),{placement:"top-center"})}},A=async e=>{try{const t=await P(e);t&&t.statusCode>=200&&t.statusCode<300?(n(j(!1)),n(h()),s.push(a.jsx(i,{title:"Berhasil Tandai Dibaca",type:"success",duration:2500,children:"Notifikasi berhasil ditandai sebagai sudah dibaca"}),{placement:"top-center"})):s.push(a.jsx(i,{title:"Gagal Tandai Dibaca",type:"danger",duration:2500,children:t.data.message||"Terjadi kesalahan saat menandai notifikasi"}),{placement:"top-center"})}catch(t){console.error("Error marking notification as read:",t),s.push(a.jsx(i,{title:"Gagal Tandai Dibaca",type:"danger",duration:2500,children:"Terjadi kesalahan saat menandai notifikasi"}),{placement:"top-center"})}},O=e=>{l({id:e}),c(!0)},T=async()=>{try{const e={id:r==null?void 0:r.id,status:"Sudah Bayar"};(await E(e)).data.statusCode===200?(s.push(a.jsx(i,{title:"Update Status Failed",type:"success",duration:2500,children:"Berhasil memperbarui status faktur"}),{placement:"top-center"}),c(!1),n(h())):s.push(a.jsx(i,{title:"Update Status Failed",type:"danger",duration:2500,children:"Gagal memperbarui status faktur"}),{placement:"top-center"})}catch(e){console.error("Error updating status faktur:",e),s.push(a.jsx(i,{title:"Update Status Failed",type:"danger",duration:2500,children:"Gagal memperbarui status faktur"}),{placement:"top-center"})}},x=()=>{c(!1)};return u.useEffect(()=>{n(h())},[location.pathname]),u.useEffect(()=>{(!d||d.length===0)&&n(j(!1))},[d,n]),a.jsxs(a.Fragment,{children:[a.jsx(F,{loading:v,children:a.jsx("div",{children:d&&d.length>0?d.map((e,t)=>a.jsxs("div",{className:`py-2 
                                ${t===0?"border-t":""}
                                ${m===e.id?"bg-slate-50":""}
                                    border-b hover:bg-slate-50 cursor-pointer pl-4`,onClick:()=>S(m===e.id?null:e.id),children:[a.jsxs("div",{className:"my-1 flex items-center",children:[a.jsx(G,{shape:"circle",className:`
                                            ${e.type==="timeline"?"bg-amber-100 text-amber-600":e.type==="adendum"?"bg-blue-100 text-blue-600":e.type==="faktur_pajak"?"bg-green-100 text-green-600":e.type==="project"?"bg-fuchsia-100 text-fuchsia-600":""}
                                            dark:bg-blue-500/20 dark:text-blue-100`,icon:a.jsx(H,{})}),a.jsx("span",{className:"ml-3 font-semibold text-gray-900 dark:text-gray-100",children:e.type}),a.jsx("span",{className:"mx-2",children:"diinfokan pada"}),a.jsxs("span",{className:"",children:[$(e.createdAt)," "]}),a.jsxs("div",{className:"flex flex-row ml-auto space-x-2 justify-center items-center",children:[e.status_baca===!1?a.jsx(o,{size:"xs",className:"flex items-center justify-center ml-auto",onClick:w=>{w.stopPropagation(),A(e)},children:"Tandai Dibaca"}):a.jsx(o,{disabled:!0,size:"xs",className:"flex items-center justify-center ml-auto",children:"Sudah Dibaca"}),a.jsx(o,{type:"button",shape:"circle",variant:"plain",size:"sm",className:"text-red-500",icon:a.jsx(b,{}),onClick:()=>D(e)})]})]}),m===e.id&&a.jsxs("div",{className:"mt-8 mb-8 ",children:[a.jsx("p",{children:e.pesan}),e.type==="faktur_pajak"&&(e.FakturPajak.status!=="Sudah Bayar"?a.jsx("div",{className:"mt-4 flex gap-3",children:a.jsx(o,{size:"sm",className:"text-xs flex justify-center items-center",variant:"solid",onClick:()=>O(e.idFakturPajak),children:"Update Status Faktur"})}):a.jsx("div",{className:"mt-4 flex gap-3",children:a.jsx(o,{disabled:!0,size:"sm",className:"text-xs flex justify-center items-center",children:"Faktur Sudah Diubah"})})),e.type==="adendum"&&a.jsx("div",{className:"mt-4 flex",children:a.jsx(o,{variant:"solid",size:"sm",className:"text-xs flex justify-center items-center",onClick:()=>f("/manajemen-proyek/adendum"),children:"Lihat Adendum"})})]})]},e.id)):a.jsx("div",{children:"data empty"})})}),a.jsx(N,{isOpen:p,onClose:x,onRequestClose:x,onCancel:x,type:"warning",title:"Ubah Status",onConfirm:T,children:a.jsxs("p",{children:["Apakah kamu yakin ingin mengubah status faktur menjadi"," ",a.jsx("strong",{children:r!=null&&r.newStatus?"belum dibayar":"sudah dibayar"}),"?"]})})]})}y("notification",C);function Z(){const n=k(),[f,p]=u.useState(!1),c=()=>{p(!1)},r=async()=>{p(!1);try{const l=await _();l&&l.data.statusCode>=200&&l.data.statusCode<300?(s.push(a.jsx(i,{title:"Berhasil Hapus Notifikasi",type:"success",duration:2500,children:"Semua notifikasi yang sudah dibaca berhasil dihapus"}),{placement:"top-center"}),n(h())):s.push(a.jsx(i,{title:"Gagal Hapus Notifikasi",type:"danger",duration:2500,children:l.data.message||"Terjadi kesalahan saat menghapus notifikasi"}),{placement:"top-center"})}catch(l){console.error("Error deleting notification:",l),s.push(a.jsx(i,{title:"Gagal Hapus Notifikasi",type:"danger",duration:2500,children:"Terjadi kesalahan saat menghapus notifikasi"}),{placement:"top-center"})}};return a.jsx(z,{children:a.jsx(U,{children:a.jsx("div",{className:"grid lg:grid-cols-5 gap-8",children:a.jsxs("div",{className:"col-span-4",children:[a.jsxs("div",{className:"flex flex-row justify-between",children:[a.jsx("h3",{className:"mb-6",children:"Semua Notifikasi"}),a.jsxs(o,{variant:"solid",size:"sm",className:"text-xs flex justify-center items-center",color:"red",onClick:()=>p(!0),children:[a.jsx(b,{className:"inline-block mr-2"}),"Bersihkan Notifikasi"]})]}),a.jsx(q,{}),a.jsx(N,{isOpen:f,onClose:c,onRequestClose:c,onCancel:c,type:"warning",title:"Ubah Status",onConfirm:r,children:a.jsx("p",{children:"Apakah kamu yakin ingin menghapus semua notifikasi yang sudah dibaca ?"})})]})})})})}export{Z as default};
