import{ai as A,aj as I,ak as z,al as E,u as v,j as t,r as g,a7 as R,a as O,L as H,i as P}from"./index-8f324225.js";import{a as F,b as $}from"./DivisiService-dc0d5bfb.js";import{A as q}from"./AdaptableCard-54b628e2.js";import{D as K}from"./DataTable-66df47f9.js";import{t as B,N as M,I as G,H as J,J as f,K as Q,L as _,B as U,Q as V}from"./Views-a6cda74e.js";import{u as W}from"./useThemeClass-fe409b1f.js";import{C as X}from"./ConfirmDialog-cacab1ef.js";import{d as Y}from"./debounce-9aa8ee7b.js";import"./index-fee04496.js";const j="divisiList",D=A(j+"/getDivisies",async a=>{const e=await F(a);return{data:e.data.data,total:e.data.totaldataDivisi,totalPage:e.data.totalPage}}),Z=async a=>(await $(a)).data,ee={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ae={loading:!1,deleteConfirmation:!1,selectedDivisi:"",divisiList:[],tableData:ee,filterData:{name:"",category:["bags","cloths","devices","shoes","b"],status:[0,1,2],divisiStatus:0}},y=I({name:`${j}/state`,initialState:ae,reducers:{updateDivisiList:(a,e)=>{a.divisiList=e.payload},setTableData:(a,e)=>{a.tableData=e.payload},setFilterData:(a,e)=>{a.filterData=e.payload},toggleDeleteConfirmation:(a,e)=>{a.deleteConfirmation=e.payload},setSelectedDivisi:(a,e)=>{a.selectedDivisi=e.payload}},extraReducers:a=>{a.addCase(D.fulfilled,(e,i)=>{e.divisiList=i.payload.data,e.tableData.total=i.payload.total,e.loading=!1}).addCase(D.pending,e=>{e.loading=!0})}}),{updateDivisiList:be,setTableData:h,setFilterData:je,toggleDeleteConfirmation:b,setSelectedDivisi:te}=y.actions,se=y.reducer,ie=z({data:se}),u=E,ne=()=>{const a=v(),e=u(r=>r.divisiList.data.deleteConfirmation),i=u(r=>r.divisiList.data.selectedDivisi),d=u(r=>r.divisiList.data.tableData),l=()=>{a(b(!1))},c=async()=>{a(b(!1)),await Z({id:i})&&(a(D(d)),B.push(t.jsx(M,{title:"Successfuly Deleted",type:"success",duration:2500,children:"Item berhasil dihapus"}),{placement:"top-center"}))};return t.jsx(X,{isOpen:e,type:"danger",title:"Hapus Divisi",confirmButtonColor:"red-600",onClose:l,onRequestClose:l,onCancel:l,onConfirm:c,children:t.jsx("p",{children:"Apakah kamu yakin ingin menghapus divisi ini?"})})},oe=({row:a})=>{const e=v(),{textTheme:i}=W(),d=R(),l=()=>{d(`/master/divisi-edit/${a.id}`)},c=()=>{e(b(!0)),e(te(a.id))};return t.jsxs("div",{className:"flex justify-end text-lg",children:[t.jsx("span",{className:`cursor-pointer p-2 hover:${i}`,onClick:l,children:t.jsx(G,{})}),t.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:c,children:t.jsx(J,{})})]})},le=()=>{const a=g.useRef(null),e=v(),i=u(s=>s.auth.user),{pageIndex:d,pageSize:l,sort:c,query:r,total:n}=u(s=>s.divisiList.data.tableData),m=u(s=>s.divisiList.data.filterData),C=u(s=>s.divisiList.data.loading),L=u(s=>s.divisiList.data.divisiList);g.useEffect(()=>{S()},[d,l,c]),g.useEffect(()=>{var s;a&&((s=a.current)==null||s.resetSorting())},[m]);const p=g.useMemo(()=>({pageIndex:d,pageSize:l,sort:c,query:r,total:n}),[d,l,c,r,n]),S=()=>{e(D({pageIndex:d,pageSize:l,sort:c,query:r,filterData:m}))},w=g.useMemo(()=>{const s=[{header:"Nama",accessorKey:"name",cell:o=>{const x=o.row.original;return t.jsx("span",{className:"capitalize",children:x.name})}},{header:"Keterangan",accessorKey:"keterangan",cell:o=>{const x=o.row.original;return t.jsx("span",{className:"capitalize",children:x.keterangan})}}];return(i==null?void 0:i.authority)!=="Admin"&&(i==null?void 0:i.authority)!=="Owner"&&s.push({header:"",id:"action",cell:o=>t.jsx(oe,{row:o.row.original})}),s},[i]),N=s=>{const o=f(p);o.pageIndex=s,e(h(o))},T=s=>{const o=f(p);o.pageSize=Number(s),o.pageIndex=1,e(h(o))},k=s=>{const o=f(p);o.sort=s,e(h(o))};return t.jsxs(t.Fragment,{children:[t.jsx(K,{ref:a,columns:w,data:L,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:C,pagingData:{total:p.total,pageIndex:p.pageIndex,pageSize:p.pageSize},onPaginationChange:N,onSelectChange:T,onSort:k}),t.jsx(ne,{})]})},re=()=>{const a=v(),e=g.useRef(null),i=u(n=>n.divisiList.data.tableData),d=Y(l,500);function l(n){const m=f(i);m.query=n,m.pageIndex=1,typeof n=="string"&&n.length>1&&c(m),typeof n=="string"&&n.length===0&&c(m)}const c=n=>{a(h(n)),a(D(n))},r=n=>{d(n.target.value)};return t.jsx(Q,{ref:e,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Cari divisi",prefix:t.jsx(_,{className:"text-lg"}),onChange:r})},ce=()=>{const a=O(e=>e.auth.user);return t.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[t.jsx(re,{}),a.authority!=="Admin"&&a.authority!=="Owner"&&t.jsx(H,{className:"block lg:inline-block md:mb-0 mb-4 md:ml-2 ",to:"/master/divisi-new",children:t.jsx(U,{block:!0,variant:"solid",size:"sm",icon:t.jsx(V,{}),children:"Tambah Divisi"})})]})};P("divisiList",ie);const de=()=>t.jsxs(q,{className:"h-full",bodyClass:"h-full",children:[t.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"mb-4 lg:mb-0",children:"Daftar Divisi Tagihan"}),t.jsx(ce,{})]}),t.jsx(le,{})]}),ye=de;export{ye as default};
