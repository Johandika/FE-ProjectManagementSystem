import{ai as C,aj as G,ak as O,al as F,r as d,u as L,j as a,S as q,i as M}from"./index-8f324225.js";import{a as $,b as B}from"./TagihanService-6b2a78dc.js";import{A as H}from"./AdaptableCard-54b628e2.js";import{D as J}from"./DataTable-66df47f9.js";import{aY as Y,a5 as Q,B as U,J as u,K as V,L as W}from"./Views-a6cda74e.js";import{u as X}from"./useThemeClass-fe409b1f.js";import{a as Z}from"./formatDate-07efb40a.js";import{d as aa}from"./debounce-9aa8ee7b.js";import"./index-fee04496.js";const b="tagihanKlienList",x=C(b+"/getTagihanKliens",async n=>{const e=await $(n);return{data:e.data.data,total:e.data.totalData,totalPage:e.data.totalPage}}),D=C(b+"/getTagihanKlien",async n=>(await B(n)).data),ea={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ta={loading:!1,loadingGetTagihanKlien:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tagihanData:[],tableData:ea,filterData:{name:"",category:["bags","cloths","devices","shoes","d"],status:[0,1,2],productStatus:0}},k=G({name:`${b}/state`,initialState:ta,reducers:{updateProductList:(n,e)=>{n.productList=e.payload},setTableData:(n,e)=>{n.tableData=e.payload},setFilterData:(n,e)=>{n.filterData=e.payload},toggleDeleteConfirmation:(n,e)=>{n.deleteConfirmation=e.payload},setSelectedProduct:(n,e)=>{n.selectedProduct=e.payload}},extraReducers:n=>{n.addCase(x.fulfilled,(e,l)=>{e.productList=l.payload.data,e.tableData.total=l.payload.total,e.tableData.totalPage=l.payload.totalPage,e.loading=!1}).addCase(x.pending,e=>{e.loading=!0}).addCase(D.fulfilled,(e,l)=>{e.tagihanData=l.payload.data,e.loadingGetTagihanKlien=!1}).addCase(D.pending,e=>{e.loadingGetTagihanKlien=!0})}}),{updateProductList:ja,setTableData:m,setFilterData:Da,toggleDeleteConfirmation:ba,setSelectedProduct:Ta}=k.actions,na=k.reducer,sa=O({data:na}),h=F,ia=()=>{var S,N;const n=d.useRef(null),e=L(),{textTheme:l}=X(),[f,p]=d.useState(!1),{pageIndex:r,pageSize:g,sort:s,query:o,total:T}=h(t=>t.tagihanKlienList.data.tableData),K=h(t=>t.tagihanKlienList.data.filterData),{loading:w,loadingGetTagihanKlien:v}=h(t=>t.tagihanKlienList.data),P=h(t=>t.tagihanKlienList.data.productList),y=h(t=>t.tagihanKlienList.data.tagihanData);d.useEffect(()=>{I()},[r,g,s]),d.useEffect(()=>{var t;n&&((t=n.current)==null||t.resetSorting())},[K]);const c=d.useMemo(()=>({pageIndex:r,pageSize:g,sort:s,query:o,total:T}),[r,g,s,o,T]),I=()=>{e(x({pageIndex:r,pageSize:g,sort:s,query:o,filterData:K}))},z=t=>{e(D({id:t})),p(!0)},j=()=>{p(!1)},_=d.useMemo(()=>[{header:"Nama",accessorKey:"nama",cell:t=>{const i=t.row.original;return a.jsx("span",{className:"capitalize",children:i.nama})}},{header:"Total Tagihan",accessorKey:"total_tagihan",cell:t=>{const i=t.row.original;return a.jsx("span",{className:"capitalize",children:i.total_tagihan.toLocaleString("id-ID")})}},{header:"",id:"action",cell:t=>{const i=t.row.original;return a.jsx("div",{className:"flex justify-end text-lg",children:a.jsx("span",{className:`cursor-pointer p-2 hover:${l}`,onClick:()=>z(i.id),children:a.jsx(Y,{})})})}}],[]),A=t=>{const i=u(c);i.pageIndex=t,e(m(i))},E=t=>{const i=u(c);i.pageSize=Number(t),i.pageIndex=1,e(m(i))},R=t=>{const i=u(c);i.sort=t,e(m(i))};return a.jsxs(a.Fragment,{children:[a.jsx(J,{ref:n,columns:_,data:P,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:w,pagingData:{total:c.total,pageIndex:c.pageIndex,pageSize:c.pageSize,totalPage:c.totalPage},onPaginationChange:A,onSelectChange:E,onSort:R}),a.jsx(Q,{isOpen:f,width:1e3,onClose:j,onRequestClose:j,children:a.jsxs("div",{className:"flex flex-col h-full justify-between",children:[a.jsx("h5",{className:"mb-4",children:"Detail Daftar Tagihan"}),a.jsx("div",{className:"overflow-y-auto bg-slate-50",children:v?a.jsx("div",{className:"flex justify-center items-center ",children:a.jsx(q,{size:100})}):a.jsx("div",{className:" max-h-[50vh] ml-6",children:((S=y.tagihan_details)==null?void 0:S.length)>0?(N=y.tagihan_details)==null?void 0:N.map((t,i)=>a.jsxs("div",{className:"flex flex-row my-2 py-4 border-b gap-2",children:[a.jsx("div",{children:a.jsx("strong",{children:`${i+1}.`})}),a.jsxs("div",{children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Pekekrjaan:"})," ",t.pekerjaan]}),a.jsxs("p",{children:[a.jsx("strong",{children:"PIC:"})," ",t.pic]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Nomor Kontrak:"})," ",t.nomor_kontrak]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Nliai Kontrak:"})," ",t.nilai_kontrak.toLocaleString("id-ID")]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Nominal Tagihan:"})," ",t.nominal_tagihan.toLocaleString("id-ID")]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Tanggal Kontrak:"})," ",Z(t.tanggal_kontrak)]})]})]},t.id)):a.jsx("div",{children:"Tidak ada detail tagihan"})})}),a.jsx("div",{className:"text-right mt-6",children:a.jsx(U,{variant:"solid",onClick:j,children:"OK"})})]})})]})},la=()=>{const n=L(),e=d.useRef(null),l=h(s=>s.tagihanKlienList.data.tableData),f=aa(p,500);function p(s){const o=u(l);o.query=s,o.pageIndex=1,typeof s=="string"&&s.length>1&&r(o),typeof s=="string"&&s.length===0&&r(o)}const r=s=>{n(m(s)),n(x(s))},g=s=>{f(s.target.value)};return a.jsx(V,{ref:e,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Cari tagihanKlien",prefix:a.jsx(W,{className:"text-lg"}),onChange:g})},oa=()=>a.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center",children:a.jsx(la,{})});M("tagihanKlienList",sa);const ra=()=>a.jsxs(H,{className:"h-full",bodyClass:"h-full",children:[a.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"mb-4 lg:mb-0",children:"Daftar Tagihan Klien"}),a.jsx(oa,{})]}),a.jsx(ia,{})]}),Ka=ra;export{Ka as default};
