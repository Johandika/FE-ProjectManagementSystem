import{i as A,u as H,r as i,j as e,c as n,S as C,L as B}from"./index-8f324225.js";import{u as L,H as E,M as T,U}from"./navigation-icon.config-ccf83bef.js";import{w as D,S as R}from"./SidePanel-48b15602.js";import{S as M,a as O}from"./SideNav-31effdc7.js";import{t as j,N as b,D as d,T as _,B as F,H as I,S as $,A as z,a as f,b as G,V}from"./Views-a6cda74e.js";import{i as P}from"./isLastChild-83eb4c23.js";import{r as Q,u as x,a as W,s as p,g as m,b as q}from"./index-ac527888.js";import{f as J}from"./formatDate-07efb40a.js";import"./index-81450355.js";import"./Logo-8a0be44f.js";import"./VerticalMenuContent-2fe114fb.js";const h="h-72";A("notification",Q);const K=({className:c,dot:s})=>e.jsx("div",{className:n("text-2xl",c),children:s?e.jsx(G,{badgeStyle:{top:"3px",right:"6px"},children:e.jsx(f,{})}):e.jsx(f,{})}),X=({className:c})=>{const s=H(),l=x(a=>a.notification.data.unreadNotification),o=x(a=>a.notification.data.dataNotification.data||[]),[y,u]=i.useState(!1),{larger:N}=L(),v=x(a=>a.theme.direction),g=i.useCallback(async()=>{try{const r=(await W()).data.data;s(p(r>0))}catch(a){console.error("Failed to get notification count:",a),s(p(!1))}},[s]);i.useEffect(()=>{g(),s(m())},[s,g]);const k=i.useCallback(()=>{o.length===0&&s(m())},[s,o.length]),w=i.useCallback(async()=>{var a,r;u(!0);try{await q(),j.push(e.jsx(b,{title:"Berhasil",type:"success",duration:2500,children:"Berhasil menghapus notifikasi yang sudah dibaca"}),{placement:"top-center"}),s(m())}catch(S){j.push(e.jsx(b,{title:"Error",type:"danger",duration:2500,children:((r=(a=S.response)==null?void 0:a.data)==null?void 0:r.message)||"Gagal menghapus notifikasi"}),{placement:"top-center"})}finally{u(!1)}},[s]);i.useEffect(()=>{const a=o.some(r=>!r.status_baca);a!==l&&s(p(a))},[o,l,s]);const t=o.filter(a=>a.status_baca===!1);return e.jsxs(d,{renderTitle:e.jsx(K,{dot:l,className:c}),menuClass:"p-0 min-w-[280px] md:min-w-[340px]",placement:N.md?"bottom-end":"bottom-center",onOpen:k,children:[e.jsx(d.Item,{variant:"header",children:e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-600 px-4 py-2 flex items-center justify-between",children:[e.jsxs("h6",{children:["Notifikasi (",t==null?void 0:t.length,")"]}),e.jsx(_,{title:"Hapus pesan yg sudah dibaca",children:e.jsx(F,{variant:"plain",shape:"circle",size:"sm",icon:e.jsx(I,{className:"text-xl"}),onClick:w})})]})}),e.jsx("div",{className:n("overflow-y-auto",h),children:e.jsx($,{direction:v,children:y?e.jsx("div",{className:n("flex items-center justify-center",h),children:e.jsx(C,{size:40})}):(t==null?void 0:t.length)===0?e.jsx("div",{className:n("flex items-center justify-center",h),children:e.jsxs("div",{className:"text-center",children:[e.jsx("img",{className:"mx-auto mb-2 max-w-[150px]",src:"/img/others/no-notification.png",alt:"no-notification"}),e.jsx("h6",{className:"font-semibold",children:"Tidak Ada Notifikasi Baru"}),e.jsx("p",{className:"mt-1",children:"Semua sudah terbaca!"})]})}):t==null?void 0:t.map((a,r)=>e.jsxs("div",{className:`relative flex px-4 py-4 active:bg-gray-100 dark:hover:bg-black dark:hover:bg-opacity-20 ${P(t,r)?"":"border-b border-gray-200 dark:border-gray-600"}`,children:[e.jsx("div",{children:e.jsx(z,{shape:"circle",className:`${a.type==="timeline"?"bg-amber-100 text-amber-600":a.type==="adendum"?"bg-blue-100 text-blue-600":a.type==="faktur_pajak"?"bg-green-100 text-green-600":a.type==="project"?"bg-fuchsia-100 text-fuchsia-600":""} dark:bg-blue-500/20 dark:text-blue-100`,icon:e.jsx(f,{})})}),e.jsxs("div",{className:"ltr:ml-3 rtl:mr-3",children:[e.jsxs("div",{className:"flex flex-col",children:[a.type&&e.jsx("span",{className:"font-semibold heading-text",children:a.type.charAt(0).toUpperCase()+a.type.slice(1).toLowerCase()}),e.jsx("span",{children:a.pesan})]}),e.jsx("span",{className:"text-xs",children:J(a.createdAt)})]})]},a.id))})}),e.jsx(d.Item,{variant:"header",children:e.jsx("div",{className:"flex justify-center border-t border-gray-200 dark:border-gray-600 px-4 py-2",children:e.jsx(B,{to:"/semua-notifikasi",className:"font-semibold cursor-pointer p-2 px-3 text-gray-600 hover:text-gray-900 dark:text-gray-200 dark:hover:text-white",children:"Lihat Semua"})})})]})},Y=D(X),Z=()=>e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsx(O,{})]}),ee=()=>e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsx(R,{}),e.jsx(U,{hoverable:!1})]}),pe=()=>e.jsx("div",{className:"app-layout-modern flex flex-auto flex-col",children:e.jsxs("div",{className:"flex flex-auto min-w-0",children:[e.jsx(M,{}),e.jsxs("div",{className:"flex flex-col flex-auto min-h-screen min-w-0 relative w-full bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700",children:[e.jsx(E,{className:"border-b border-gray-200 dark:border-gray-700",headerEnd:e.jsx(ee,{}),headerStart:e.jsx(Z,{})}),e.jsx(V,{})]})]})});export{pe as default};
