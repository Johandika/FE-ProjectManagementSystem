import{ai as A,aj as I,ak as v,al as z,u as k,j as t,r as b,a7 as E,a as R,L as O,i as H}from"./index-8f324225.js";import{b4 as P,b5 as F,t as $,N as q,I as M,H as K,J as g,K as G,L as J,B as Q,Q as _}from"./Views-a6cda74e.js";import{A as U}from"./AdaptableCard-54b628e2.js";import{D as V}from"./DataTable-66df47f9.js";import{u as W}from"./useThemeClass-fe409b1f.js";import{C as X}from"./ConfirmDialog-cacab1ef.js";import{d as Y}from"./debounce-9aa8ee7b.js";import"./index-fee04496.js";const D="berkasList",f=A(D+"/getBerkases",async a=>{const e=await P(a);return{data:e.data.data,total:e.data.totaldataMasterBerkas,totalPage:e.data.totalPage}}),Z=async a=>(await F(a)).data,ee={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ae={loading:!1,deleteConfirmation:!1,selectedBerkas:"",berkasList:[],tableData:ee,filterData:{name:"",category:["bags","cloths","devices","shoes","b"],status:[0,1,2],berkasStatus:0}},j=I({name:`${D}/state`,initialState:ae,reducers:{updateBerkasList:(a,e)=>{a.berkasList=e.payload},setTableData:(a,e)=>{a.tableData=e.payload},setFilterData:(a,e)=>{a.filterData=e.payload},toggleDeleteConfirmation:(a,e)=>{a.deleteConfirmation=e.payload},setSelectedBerkas:(a,e)=>{a.selectedBerkas=e.payload}},extraReducers:a=>{a.addCase(f.fulfilled,(e,n)=>{e.berkasList=n.payload.data,e.tableData.total=n.payload.total,e.loading=!1}).addCase(f.pending,e=>{e.loading=!0})}}),{updateBerkasList:xe,setTableData:h,setFilterData:De,toggleDeleteConfirmation:x,setSelectedBerkas:te}=j.actions,se=j.reducer,ne=v({data:se}),u=z,oe=()=>{const a=k(),e=u(l=>l.berkasList.data.deleteConfirmation),n=u(l=>l.berkasList.data.selectedBerkas),d=u(l=>l.berkasList.data.tableData),i=()=>{a(x(!1))},c=async()=>{a(x(!1)),await Z({id:n})&&(a(f(d)),$.push(t.jsx(q,{title:"Successfuly Deleted",type:"success",duration:2500,children:"Item berhasil dihapus"}),{placement:"top-center"}))};return t.jsx(X,{isOpen:e,type:"danger",title:"Hapus Berkas",confirmButtonColor:"red-600",onClose:i,onRequestClose:i,onCancel:i,onConfirm:c,children:t.jsx("p",{children:"Apakah kamu yakin ingin menghapus berkas ini?"})})},re=({row:a})=>{const e=k(),{textTheme:n}=W(),d=E(),i=()=>{d(`/master/berkas-edit/${a.id}`)},c=()=>{e(x(!0)),e(te(a.id))};return t.jsxs("div",{className:"flex justify-end text-lg",children:[t.jsx("span",{className:`cursor-pointer p-2 hover:${n}`,onClick:i,children:t.jsx(M,{})}),t.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:c,children:t.jsx(K,{})})]})},ie=()=>{const a=b.useRef(null),e=k(),n=u(s=>s.auth.user),{pageIndex:d,pageSize:i,sort:c,query:l,total:o}=u(s=>s.berkasList.data.tableData),m=u(s=>s.berkasList.data.filterData),y=u(s=>s.berkasList.data.loading),C=u(s=>s.berkasList.data.berkasList);b.useEffect(()=>{B()},[d,i,c]),b.useEffect(()=>{var s;a&&((s=a.current)==null||s.resetSorting())},[m]);const p=b.useMemo(()=>({pageIndex:d,pageSize:i,sort:c,query:l,total:o}),[d,i,c,l,o]),B=()=>{e(f({pageIndex:d,pageSize:i,sort:c,query:l,filterData:m}))},L=b.useMemo(()=>{const s=[{header:"Nama",accessorKey:"nama",cell:r=>{const w=r.row.original;return t.jsx("span",{className:"capitalize",children:w.nama})}}];return(n==null?void 0:n.authority)!=="Admin"&&(n==null?void 0:n.authority)!=="Owner"&&s.push({header:"",id:"action",cell:r=>t.jsx(re,{row:r.row.original})}),s},[n]),S=s=>{const r=g(p);r.pageIndex=s,e(h(r))},N=s=>{const r=g(p);r.pageSize=Number(s),r.pageIndex=1,e(h(r))},T=s=>{const r=g(p);r.sort=s,e(h(r))};return t.jsxs(t.Fragment,{children:[t.jsx(V,{ref:a,columns:L,data:C,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:y,pagingData:{total:p.total,pageIndex:p.pageIndex,pageSize:p.pageSize},onPaginationChange:S,onSelectChange:N,onSort:T}),t.jsx(oe,{})]})},le=()=>{const a=k(),e=b.useRef(null),n=u(o=>o.berkasList.data.tableData),d=Y(i,500);function i(o){const m=g(n);m.query=o,m.pageIndex=1,typeof o=="string"&&o.length>1&&c(m),typeof o=="string"&&o.length===0&&c(m)}const c=o=>{a(h(o)),a(f(o))},l=o=>{d(o.target.value)};return t.jsx(G,{ref:e,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Cari berkas",prefix:t.jsx(J,{className:"text-lg"}),onChange:l})},ce=()=>{const a=R(e=>e.auth.user);return t.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[t.jsx(le,{}),a.authority!=="Admin"&&a.authority!=="Owner"&&t.jsx(O,{className:"block lg:inline-block md:mb-0 mb-4 md:ml-2 ",to:"/master/berkas-new",children:t.jsx(Q,{block:!0,variant:"solid",size:"sm",icon:t.jsx(_,{}),children:"Tambah Berkas"})})]})};H("berkasList",ne);const de=()=>t.jsxs(U,{className:"h-full",bodyClass:"h-full",children:[t.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"mb-4 lg:mb-0",children:"Daftar Berkas Tagihan"}),t.jsx(ce,{})]}),t.jsx(ie,{})]}),je=de;export{je as default};
