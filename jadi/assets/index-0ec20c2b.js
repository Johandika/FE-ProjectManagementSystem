import{ai as I,aj as v,ak as z,al as E,u as S,j as e,r as f,a7 as R,a as O,L as H,i as P}from"./index-8f324225.js";import{a as F,b as $}from"./SatuanService-a4bac9a4.js";import{A as q}from"./AdaptableCard-54b628e2.js";import{D as B}from"./DataTable-66df47f9.js";import{t as M,N as K,I as G,H as J,J as h,K as Q,L as _,B as U,Q as V}from"./Views-a6cda74e.js";import{u as W}from"./useThemeClass-fe409b1f.js";import{C as X}from"./ConfirmDialog-cacab1ef.js";import{d as Y}from"./debounce-9aa8ee7b.js";import"./index-fee04496.js";const D="satuanList",g=I(D+"/getSatuans",async t=>{const a=await F(t);return{data:a.data.data,total:a.data.totaldataSatuan,totalPage:a.data.totalPage}}),Z=async t=>(await $(t)).data,aa={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ta={loading:!1,deleteConfirmation:!1,selectedSatuan:"",satuanList:[],tableData:aa,filterData:{name:"",category:["bags","cloths","devices","shoes","c"],status:[0,1,2],satuanStatus:0}},j=v({name:`${D}/state`,initialState:ta,reducers:{updateSatuanList:(t,a)=>{t.satuanList=a.payload},setTableData:(t,a)=>{t.tableData=a.payload},setFilterData:(t,a)=>{t.filterData=a.payload},toggleDeleteConfirmation:(t,a)=>{t.deleteConfirmation=a.payload},setSelectedSatuan:(t,a)=>{t.selectedSatuan=a.payload}},extraReducers:t=>{t.addCase(g.fulfilled,(a,o)=>{a.satuanList=o.payload.data,a.tableData.total=o.payload.total,a.loading=!1}).addCase(g.pending,a=>{a.loading=!0})}}),{updateSatuanList:Da,setTableData:x,setFilterData:ja,toggleDeleteConfirmation:b,setSelectedSatuan:ea}=j.actions,sa=j.reducer,na=z({data:sa}),d=E,oa=()=>{const t=S(),a=d(c=>c.satuanList.data.deleteConfirmation),o=d(c=>c.satuanList.data.selectedSatuan),r=d(c=>c.satuanList.data.tableData),l=()=>{t(b(!1))},u=async()=>{t(b(!1)),await Z({id:o})&&(t(g(r)),M.push(e.jsx(K,{title:"Successfuly Deleted",type:"success",duration:2500,children:"Item berhasil dihapus"}),{placement:"top-center"}))};return e.jsx(X,{isOpen:a,type:"danger",title:"Hapus Satuan",confirmButtonColor:"red-600",onClose:l,onRequestClose:l,onCancel:l,onConfirm:u,children:e.jsx("p",{children:"Apakah kamu yakin ingin menghapus satuan ini?"})})},ia=({row:t})=>{const a=S(),{textTheme:o}=W(),r=R(),l=()=>{r(`/master/satuan-edit/${t.id}`)},u=()=>{a(b(!0)),a(ea(t.id))};return e.jsxs("div",{className:"flex justify-end text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${o}`,onClick:l,children:e.jsx(G,{})}),e.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:u,children:e.jsx(J,{})})]})},la=()=>{const t=f.useRef(null),a=S(),{pageIndex:o,pageSize:r,sort:l,query:u,total:c}=d(s=>s.satuanList.data.tableData),n=d(s=>s.auth.user),p=d(s=>s.satuanList.data.filterData),y=d(s=>s.satuanList.data.loading),C=d(s=>s.satuanList.data.satuanList);f.useEffect(()=>{L()},[o,r,l]),f.useEffect(()=>{var s;t&&((s=t.current)==null||s.resetSorting())},[p]);const m=f.useMemo(()=>({pageIndex:o,pageSize:r,sort:l,query:u,total:c}),[o,r,l,u,c]),L=()=>{a(g({pageIndex:o,pageSize:r,sort:l,query:u,filterData:p}))},w=f.useMemo(()=>{const s=[{header:"Satuan",accessorKey:"satuan",cell:i=>{const A=i.row.original;return e.jsx("span",{className:"capitalize",children:A.satuan})}}];return(n==null?void 0:n.authority)!=="Admin"&&(n==null?void 0:n.authority)!=="Owner"&&s.push({header:"",id:"action",cell:i=>e.jsx(ia,{row:i.row.original})}),s},[n]),N=s=>{const i=h(m);i.pageIndex=s,a(x(i))},T=s=>{const i=h(m);i.pageSize=Number(s),i.pageIndex=1,a(x(i))},k=s=>{const i=h(m);i.sort=s,a(x(i))};return e.jsxs(e.Fragment,{children:[e.jsx(B,{ref:t,columns:w,data:C,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:y,pagingData:{total:m.total,pageIndex:m.pageIndex,pageSize:m.pageSize},onPaginationChange:N,onSelectChange:T,onSort:k}),e.jsx(oa,{})]})},ca=()=>{const t=S(),a=f.useRef(null),o=d(n=>n.satuanList.data.tableData),r=Y(l,500);function l(n){const p=h(o);p.query=n,p.pageIndex=1,typeof n=="string"&&n.length>1&&u(p),typeof n=="string"&&n.length===0&&u(p)}const u=n=>{t(x(n)),t(g(n))},c=n=>{r(n.target.value)};return e.jsx(Q,{ref:a,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Cari satuan",prefix:e.jsx(_,{className:"text-lg"}),onChange:c})},ra=()=>{const t=O(a=>a.auth.user);return e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[e.jsx(ca,{}),t.authority!=="Admin"&&t.authority!=="Owner"&&e.jsx(H,{className:"block lg:inline-block md:mb-0 mb-4 md:ml-2 ",to:"/master/satuan-new",children:e.jsx(U,{block:!0,variant:"solid",size:"sm",icon:e.jsx(V,{}),children:"Tambah Satuan"})})]})};P("satuanList",na);const ua=()=>e.jsxs(q,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Daftar Satuan"}),e.jsx(ra,{})]}),e.jsx(la,{})]}),ya=ua;export{ya as default};
